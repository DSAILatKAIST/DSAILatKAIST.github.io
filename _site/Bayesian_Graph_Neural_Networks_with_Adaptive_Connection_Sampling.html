<!DOCTYPE html>
<html>
<head>
    <meta name="google-site-verification" content="1tAPTdgw0-t8G2Bya463OpBtYUbj9Um93gfnsowYKLw" />
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[ICML 2020] Bayesian Graph Neural Networks with Adaptive Connection Sampling | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://dsailatkaist.github.io/feed.xml">


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>




    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS535_2023.html">DS535 (2023)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [ICML 2020] Bayesian Graph Neural Networks with Adaptive Connection Sampling page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[ICML 2020] Bayesian Graph Neural Networks with Adaptive Connection Sampling">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
          
          
          <li><a title="DS535 (2023F)" href="reviews_DS535_2023.html">DS535 (2023F)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[ICML 2020] Bayesian Graph Neural Networks with Adaptive Connection Sampling</h1>
        <p class="post-meta"><time datetime="2022-10-16T00:00:00+09:00" itemprop="datePublished">Oct 16, 2022</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h3 id="review-bayesian-graph-neural-network-with-adaptive-connection-sampling">[Review] Bayesian Graph Neural Network with Adaptive Connection Sampling</h3>

<h4 id="0-본-논문을-온전히-이해하기-위해-알면-좋을-사전-지식들">0. 본 논문을 온전히 이해하기 위해 알면 좋을 사전 지식들</h4>

<ul>
  <li>
    <p>Variational Inference</p>
  </li>
  <li>
    <p>Random process - Indian buffet process</p>
  </li>
  <li>
    <p>미분 불가능한 값들을 Neural Network에 적용하기 위해 필요한 조치</p>
  </li>
</ul>

<p>경고 - 본 논문은 수식이 매우 많이 나옵니다. 각 수식을 이해하기에 앞서, 각 파트별로 정리한 내용을 먼저 참고하신 후 수식을 보실 것을 권장합니다.</p>

<h4 id="1-문제-정의">1. 문제 정의</h4>

<ul>
  <li>
    <p>Graph Neural Networks(이하 GNN)은 그래프에서 좋은 representation learning 측면에서 좋은 성과를 많이 내왔다.</p>
  </li>
  <li>
    <p>하지만 GNN은 아래 2가지 한계점이 있다.</p>

    <ol>
      <li>
        <p>과적합 및 Over-smoothing 으로 인해 깊은 레이어층을 쌓았을 때 성능이 악화된다.</p>
      </li>
      <li>
        <p>그래프 구조의 복잡성으로 인해 불확실성을 측정할 수 있는 Bayesian neural Network(이하 BNN) 적용에 어려움이 있다.</p>
      </li>
    </ol>
  </li>
</ul>

<h4 id="2-연구-동기">2. 연구 동기</h4>

<ul>
  <li>
    <p>과적합을 해결하는 기존의 다양한 방법이 존재한다. 하지만 Over-smoothing 문제까지 함께 해결하는 방법이 없다. 따라서 둘을 함께 해결하는 방법을 찾을 필요가 있다.</p>

    <ul>
      <li>
        <p>Deep neural network에서 과적합을 해결하기 위해 Dropout을 많이 사용한다. 하지만 Dropout은 GNN에서  Laplacian smoothing을 활용하는데, 이는 층을 깊게 했을 때 주변 노드로의 표현값과 유사해지는 Over-smoothing 문제를 일으킨다.</p>
      </li>
      <li>
        <p>최근(Rong et al., 2019) 연구에서 Dropout와 DropEdge를 함께 사용했을 때 과적합과 Over smoothing 문제를 일부 해결하였다. 하지만 그 외에 Dropout 기반 방식에 대한 연구는 따로 없다.</p>
      </li>
      <li>
        <p>또한 기존의 방법에서는 Dropout rate를 하나의 상수 값처럼 다뤘었다. 본 연구에서는 Dropout rate를 데이터셋에 맞춰 최적화할 것이다.</p>
      </li>
    </ul>

    <p><br /></p>
  </li>
  <li>
    <p>GNN의 정보를 포괄적으로 활용하며 일반화할 수 있는 BNN 적용 방법이 아직 없다.</p>

    <ul>
      <li>
        <p>Bayesian은 1) 환경의 노이즈로 측정 향상을 통해 개선 가능한 aleatoric uncertainty (= $P(D \vert H)$ : 우도)과 모델의 적합도로 데이터 확보를 통해 개선 가능한 Epistemic uncertainty( = $P(H \vert D)$ : 사후 확률)을 분리하여 고려할 수 있다는 강점이 있다.</p>
      </li>
      <li>
        <p>최근들어 Bayesian을 Neural Network에 적용하는데 성공했다. 이때 해결해야하는 문제는 2가지였다.</p>
      </li>
      <li>
        <p>첫째, Stochastic한 변수들에 대해 미분을 어떻게 적용할 것인가. Neural Network은 Gradient descent을 통해 모델을 학습한다. 따라서 미분이 불가능하다면 Neural Network에 적용할 수 없다. 하지만 1) score-function gradient estimator, 2) continuous relaxation of the drop masks 방법 등을 통해 Stocastic한 변수들도 미분할 수 있게 되었다.</p>
      </li>
      <li>
        <p>두번째로, Bayesian에서 사후 확률(Posterior) 계산에 필요한 Evidence form($\int P(D\vert H) P(H) dH))$을 어떻게 구할 것인가. 적분식을 풀기 위해선 어마어마한 계산량을 필요로 한다. 따라서  실제로 사용하기엔 제약이 있었다. 하지만 Sampling 기반의 MCMC 방법을 통해 Evidence form에 대한 근사값을 계산해내어, 최근 Convolution neural network(이하 CNN)에 성공적으로 적용한 연구가 발표되었다(Gal &amp; Ghahramani, 2015).</p>
      </li>
      <li>
        <p>이후 GNN에서도 관측된 그래프를 임의의 랜덤 그래프 모델에서 파라미터를 바꾼 형태로 고려하여 BNN을 적용한 연구가 있다(Zhang et al. 2019). 하지만 이 방식은 막대한 계산양 뿐만 아니라 어떤 랜덤 그래프 모델을 설정하는 가가 성능에 큰 영향을 미쳐, 다른 문제에 동일하게 적용할 수 없다. 또한 불확실성을 학습함에 있어서 그래프의 노드를 무시하고, 그래프의 위상만 고려했다는 한계가 있다.</p>
      </li>
    </ul>

    <p><br /></p>
  </li>
  <li>
    <p>따라서 이 연구는 <mark>1) 과적합 및 Over-smooth를 방지하고자 Graph DropoutConnect을 제안</mark>하며, <mark>2) BNN 활용 간 Graph 전반의 정보를 사용하도록  할 것</mark>이다. 마지막으로 <mark>3) Dropout rate를 데이터에 맞춰 적응시켜 모델 성능을 향상시킬 것이다.</mark></p>

    <p><br /></p>
  </li>
</ul>

<h4 id="3-방법">3. 방법</h4>

<ul>
  <li>이 연구에서 제시하는 방법은 크게 3가지다.
    <ol>
      <li><strong>Dropout 방식을 일반화한 Graph DropoutConnect(이하 GDC)를 제안한다.</strong></li>
    </ol>

    <blockquote>
      <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/1.png" alt="" /></p>

      <p>$H^{(l)}$ : $l_{th}$ Hidden layer of GNN</p>

      <p>$\sigma(.)$ : Activation function</p>

      <p>$f_l$ : the number of features of $l_{th}$ layer</p>

      <p>$\mathfrak{N}$(A) : normalizing operator i.e. $\mathfrak{N}(A) = I_N + D^{-\frac{1}{2}} AD^{-\frac{1}{2}}$</p>

      <p>$\bigodot$ : Hadamard product</p>

      <p>$Z^{(l)}$ : Dropout 형태를 결정하는 Matrix.  Random binary matrix</p>

      <ul>
        <li>$z_{i,j}$ 값이 {0, 1} 중에서 선택되는 것은 베르누이 분포를 따른다고 가정한다.</li>
      </ul>

      <p>$W^{(l)}$ : Feature translate $l$ layer to $l+1$ layer</p>
    </blockquote>

    <p><br /></p>

    <ul>
      <li>
        <p>Dropout Connect의 일반화 증명</p>

        <ul>
          <li>$Z_{i,j}^{(l)}$ 의 값을 어떻게 설정하냐에 따라서 Dropout, Drop edge, Node sampling의 결과가 나온다.</li>
        </ul>

        <blockquote>
          <p>Ex 1 - Drop out) $Z^{(l)} \in$ ${0, 1}^{n \times f_l}$</p>

          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/3.png" alt="" /></p>
        </blockquote>

        <blockquote>
          <p>Ex 2 - Drop edge) $Z^{(l)} \in $ ${0,1}^{n \times n}$</p>

          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/4.png" alt="" /></p>
        </blockquote>

        <blockquote>
          <p>Ex 3 - Node Sampling) $diag(z^{(l)}) \in$ ${0,1}^{n \times n}$</p>

          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/5.png" alt="" /></p>
        </blockquote>

        <p>→ GDC 수식을 통해 3가지 Dropout 방법 모두를 표현할 수 있다. 따라서 <mark>GDC를 최적화하는 것은 3가지 Dropout의 조합을 최적화하는 것과 동일하다. </mark></p>
      </li>
    </ul>

    <p><br /></p>

    <ul>
      <li>
        <p>추가로 GDC는 그래프 노드 예측을 위해 Neighborhood aggregation을 할 때, 각 채널별로 독립적으로 시행한다.</p>

        <ul>
          <li>
            <p>채널간 연결을 유지한다면 채널 간의 Over smoothing 현상이 일어날 수 있다.</p>
          </li>
          <li>
            <p>이를 방지하고자 채널별로 GDC를 독립적으로 수행할 필요가 있다.
<br /></p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><strong>&lt;3-1.정리&gt;</strong></p>

<p>=&gt; Dropout과 Dropedge의 조합이 과적합 및 Oversmoothing 문제를 해결하였음을 이전 연구를 통해 확인했다. 따라서 Dropout과 Dropedge, Node sampling 의 조합을 최적화한 GDC는 더욱 효과적으로 해결할 수 있다. 또한 각 채널 간의 Over smoothing을 방지하기 위해 채널 간 GDC를 독립적으로 수행한다.</p>

<p><br /></p>

<ol>
  <li>
    <p><strong>GDC sampling이 Message passing과 동일하게 볼 수 있다는 점을 통해 Graph의 노드 정보까지 활용하는 BNN 모델을 만든다</strong></p>

    <ul>
      <li>
        <p>GDC에서는 각 GNN의 Layer마다 Masking을 통해  학습에 활용할 Adjacency Node를 Sampling한다. 이는 GNN 모델에서의 Message passing로 해석될 수 있다.</p>

        <ul>
          <li>GDC 식을  $l+1$ 층의 Hidden value v ($h_v^{(l+1)}$)로 범위를 좁혀보자</li>
        </ul>

        <blockquote>
          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/6.png" alt="" /></p>

          <blockquote>
            <p>$c_v$ : Constant derived from the degree of node v</p>

            <p>$z_{vu}^{(l)}\in {0,1}^{1 \times f_l}$ : $l$ layer 층의 node u 의 값 중 어떤 것을 $l+1$ layer 층에 있는  node v 로 보낼지 결정하는 Mask row vector.</p>
          </blockquote>
        </blockquote>

        <blockquote>
          <p>이 식을 풀어내면 아래와 같다.</p>

          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/7.png" alt="" />$(s.t. W_{vu}^{(l)} := z_{uv}^{(l)}W^{(l)}
)$</p>

          <blockquote>
            <p>$c_v$ 는 계산을 간편하게 해주기 위해서 생략.</p>
          </blockquote>
        </blockquote>

        <ul>
          <li>
            <p>Message passing에 대한 식은 아래와 같다.</p>

            <p>$h_v^{l+1} = \sigma(W_l AGG({h_u^{(l)} \vert u \in N(v)}))$</p>
          </li>
          <li>
            <p>즉, 위의 식은<u> 노드 v에 대해서 Neighborhood에 있는 노드들을 통해 Message passing 하는 것으로 해석</u>할 수 있다.</p>
            <ul>
              <li>Message passsing은 각 노드들의 정보를 반영한다.</li>
              <li><mark>즉, GDC 방법 또한 Node 정보를 반영한다. </mark></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>

    <p><br /></p>

    <ul>
      <li>
        <p>더 나아가 우리는 GDC를 통해 구한 $h_v^{l+1}$ 값이 evidence form $p_\theta(w)$의 근사값$q_\theta(\theta)$임을 유추할 수 있다</p>

        <ul>
          <li>
            <p>우린 Gal(2017)연구를 통해 “GNN 모델의 Message passing은 BNN의 evidence form $p_\theta(w)$을 근사하는 것과 동일함” 을 알고 있다.</p>
          </li>
          <li>
            <p>정리하면, GDC를 통한 Random masking을 통한 $h_v^{l+1}$ 값은 GNN 모델의 Message passing 의 한 형태로 볼 수 있다. 그리고 Message passing 결과는 GAL 연구를 통해 BNN의 Evidence form을 근사한 결과와 동일함을 안다.</p>
          </li>
          <li>
            <p><u>즉, GDC을 통해 구한 값은 Evidence form의 근사값$q_\theta(w)$가 된다.</u></p>

            <blockquote>
              <p>Tip1. 실제 분포인 $p_\theta(w)$을 구하긴 어렵다. 따라서 이와 유사하지만 우리가 구하기 쉬운 분포를 $q_\theta(w)$로 설정한다.</p>

              <p>Tip2. 모델을 보다 쉽게 표현하기 위해 활용하는 변수들을 Variational paramter라고 부르며, 이를 활용한 예측을 Variational inference라 부른다.  $q_\theta(w)$ 의 경우 Variational distribution이라고 부른다.</p>
            </blockquote>
          </li>
        </ul>
      </li>
    </ul>

    <p><br /></p>

    <ul>
      <li>
        <p>이때, 근사값인 $q_\theta(w)$가 본래 분포인 $p(w)$ 에서 많이 벗어나지 않도록 Kullback-Leibler(이하 KL) divergence를 추후 Variational inference 간 규제항으로 삼는다.</p>

        <blockquote>
          <p>KL divergence : 
\(KL(q_{\theta_l}(W_e^{(l)}) || p(W_e^{(l)}))\)</p>

          <p>let $q_{\theta_l}(W_e^{l}) = \pi_l \delta(W_e^{(l)} -0) + (1- \pi_l)\delta(W_e^{(l)} - M^{(l)})$</p>

          <blockquote>
            <p>$\delta$ : dirac delta function</p>
          </blockquote>
        </blockquote>

        <ul>
          <li>
            <p>이때, 사전 분포를 discrete quantisd Gaussian 분포라고 가정한다. 이는 KL term에 대한 Analytically한 평가를 가능하게 한다.(Gal et al, 2017).</p>
          </li>
          <li>
            <p>각 층별 분포를 independent하다고 가정했기 때문에 Factorize를 통해 \(q_\theta(W)\) 와 \(p(W)\)의 계산을 쉽게 할 수 있다.</p>

            <!-- > $$KL(q_{\theta})(w \vert \vert p(w) =\sum_{l=1}^L\sum_{e=1}^{|\varepsilon|} KL(q_{\theta_l}(W_e^{(l)}) || p(W_e^{(l)}))$$ -->
            <blockquote>
              <p>\(KL(q_{\theta})(w \vert \vert p(w) =\sum_{l=1}^L\sum_{e=1}^{\vert \varepsilon \vert} KL(q_{\theta_l}(W_e^{(l)}) \vert\vert p(W_e^{(l)}))\)
<img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/8.png" alt="" /></p>

              <p>$M^{(l)}$ : network weight parameters</p>

              <p>$\mathcal{H}(\pi)$ : Entropy of success rate $\pi$</p>
            </blockquote>
          </li>
        </ul>

        <p><br /></p>
      </li>
      <li>
        <p>마지막으로 Loss 함수를 최소로 만드는 값 $\theta = {M, \pi}$ 을 미분을 통해 구한다</p>

        <blockquote>
          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/9.png" alt="" /></p>

          <blockquote>
            <p>$Y_0$ : the collection of the available labels for the observed nodes</p>
          </blockquote>
        </blockquote>

        <ul>
          <li>
            <p>$M$ 에 대한 최적화는 Monte Carlo sampling을 통해서 계산할 수 있다.</p>
          </li>
          <li>
            <p>하지만 $\pi$는 Binary 값으로 미분이 불가능하여, 추가 조치없인 Gradient descent 방식을 적용할 수 없다.</p>

            <ul>
              <li>여기에선 최근에 개발된 Augment-REINFORCE-Merge(ARM) 방법(Yin &amp; zhou, 2019; Uin et al., 2020)을 채택한다.</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>

    <p><br /></p>

    <p><strong>&lt;3-2. 정리&gt;</strong></p>

    <p>=&gt; GDC 방식을 통해 $l+1$ layer의 값을 계산하는 것은 GNN의 Message passing 방법으로 해석되며, 이는 GDC가 Graph의 노드 정보를 반영하고 있음을 의미한다. 다음으로 BNN의 모델을 구성하기 위해 필요한 값들을 하나씩 구한다. 먼저 Bayesian의 Posterior을 구하기위해 필요한 evidence form의 근사값 $q_\theta(w)$은  Gal(2017)을 통해 Message passing 의 결과, 즉 GDC의 결과임을 알 수 있다. 이후 모델 학습을 위해 Loss 함수를 정의하며, 이때 Binary 값을 미분가능하게 만들기 위해 Augment-Reinforce-Merge 방법을 적용한다.</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>Droprate($\pi_l$)을 Hierarchical beta-Bernoulli 로 모델링하여 주어진 데이터셋에 최적화한다</strong></p>

    <ul>
      <li>
        <p>Beta-Bernoulli process의 Marginal representation이 Indian Buffet Process 로 보일 수 있다(Ghahramain &amp; Grifiths, 2006).</p>

        <blockquote>
          <p>Tip1. Neural network에서 적절한 Layer의 개수를 최적화하기 위해 Random process를 활용한다.</p>

          <p>Tip2. Indian Buffet process는 Random process에서 distribution을 유추하기 위해 적용하는 Sampling base Scheme이다.</p>
        </blockquote>
      </li>
      <li>
        <p>이를 활용하여, binary random mask를 아래와 같이 제안하겠다.</p>

        <blockquote>
          <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/10.png" alt="" /></p>

          <p>$a_e^{(l)}$ : element of the adjacency matrix A corresponding to edge e</p>

          <p>$\hat a_e^{(l)}$ : element of the matrix $\hat A^{(l)} = A \bigodot Z^{(l)}$</p>
        </blockquote>
      </li>
    </ul>

    <p><br /></p>

    <ul>
      <li>
        <p>Hierarchical beta-Bernoulli GDC 계산을 위한 방법으로 Gibbs sampling이 있지만, 큰 데이터 셋에 적용하기엔 계산양이 많다. 따라서 계산양이 적은 Variational inference 방식을 제안한다.</p>

        <ul>
          <li>
            <p>Variational distribution을 $q(Z^{(l)}, \pi_l) = q(Z^{(l)} \vert \pi_l) q(\pi_l)$ 으로 정의한다.</p>

            <blockquote>
              <p>$q(\pi_l) : q(\pi_l; a_l, b_l) = a_lb_l\pi_l^{a_l-1}(1-\pi_l^{a_l})^{b_l-1} s.t. a_l, b_l &gt; 0$</p>

              <p>$l$ 층의 beta 분포를 대체하기 위해 Kumaraswamy distribution로 가정</p>
            </blockquote>

            <ul>
              <li>앞서 dicrete quantised Gaussian 분포로 가정했기 때문에 각 egde가 독립이다. 따라서 \(q(Z^{(l)}\vert \pi_l) = \prod_{e=1}^{\vert \varepsilon \vert}q(z_e^{(l)}\vert \pi_l)\)로 표현할 수 있다.</li>
            </ul>
          </li>
          <li>
            <p>정의한 $\pi_l$에 대한 Bernoulli distribution을 KL-term 및 Loss함수에 적용한다.</p>

            <blockquote>
              <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/11.png" alt="" /></p>
            </blockquote>

            <blockquote>
              <p>KL-term의 첫번째 항은 p,q 간에 동일한 분포를 가지고 있어 0이 된다. 따라서 두번쨰 항만 계산하면 된다.</p>

              <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/12.png" alt="" /></p>

              <blockquote>
                <p>$\gamma $ : Euler-Mascheroni constant</p>

                <p>$\Psi(.)$ : Digamma function</p>
              </blockquote>
            </blockquote>
          </li>
          <li>
            <p>이때 Random mask의 값이 Discrete하기 때문에 KL-term을 바로 미분할 수 없다.</p>

            <ul>
              <li>
                <p>가능한 방법 중 하나로 concrete distribution relaxation (Jang et al., 2016; Gal et al., 2017) 이 있으나, 이 방법은 큰 분산을 가져 모델의 정확도를 떨어트릴 수 있다.</p>
              </li>
              <li>
                <p>따라서 이 연구에서는 Boluki 연구(Boluki et al.)와 동일하게  ARM estimator을 적용함으로써 문제를 해결하겠다. 
<br /></p>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p><strong>&lt;3-3. 정리&gt;</strong></p>

<p>=&gt; Droprate를 최적화해주기 위해 Neural network로 모델링한다. Neural Network의 Layer 개수 k개를 최적화하기 위해 Random Process를 적용한다. 이때 각 노드별 Masking 유무는 0,1 이므로 Beta-Binomial Process 형태를 띈다. Beta-Binomial process을 통해 Beta 분포를 최적화하고자 Indian buffet process을 통해 distribution을 모델링한다. 이후 Loss 함수을 통해 최적화해주며, 이 과정에서 미분 불가능한 값에 대해  ARM-estimator을 적용해준다.</p>

<p><br /></p>

<h4 id="4-실험">4. 실험</h4>

<ul>
  <li>
    <p>실험 환경</p>

    <ul>
      <li>
        <p>Dataset : Cora, Citeseer, Cora-ML dataset</p>
      </li>
      <li>
        <p>Condition</p>

        <ul>
          <li>
            <p>Learning rate : 0.005</p>
          </li>
          <li>
            <p>Layer : 2층 이상. paramener 학습을 위해 50 warm-up training.</p>
          </li>
          <li>
            <p>Dimension of output feature : 128</p>
          </li>
          <li>
            <p>L2-regularization foctor : $5 \times 10^{-3}$, $10^{-2}$ and $10^{-3}$ for each dataset</p>
          </li>
          <li>
            <p>Temperature of concrete distribution : 0.67</p>
          </li>
        </ul>

        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>실험 1 : Drouout 방식에 따른 노드 분류 정확도 비교</strong></p>

    <ul>
      <li>Baseline : GCN with Dropout(DO), GCN with DropEdge(DE), GCN with DO and DE</li>
    </ul>

    <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/15.png" alt="" /></p>

    <blockquote>
      <p>BBDE : Beta-Bernoulli DropEdge.</p>

      <ul>
        <li>DropEdge 기반 모델에 최적화된 Dropout rate를 활용</li>
      </ul>

      <p>BBGDC : Beta-Bernoulli Graph Dropout Connect</p>

      <ul>
        <li>GDC 기반 모델에 최적화된 Dropout rate를 활용</li>
      </ul>
    </blockquote>

    <p>-&gt; BBGDC 방법이 Dropout 방법 중 SOTA 성능을 달성한다. 대부분의 경우 Dropout과 DropEgde을 개별적으로 적용했을 때보다 같이 사용했을 때 성능이 향상됨을 알 수 있다. 또한 모델링을 통해 Dropout rate을 최적화했을 때 항상 성능이 항상된다. BBGDC을 제외한 다른 방법들은 항상 레이어 층을 늘렸을 때 성능이 떨어지나, BBGDC는 Citeseer의 경우를 제외하고 성능이 향상되었다.</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>실험 2 : Dropout rate 최적화 방식에 따른 분류 정확도 비교</strong></p>

    <ul>
      <li>Baseline : Bernoulli DropEdge with ARM(BDE-ARM), Beta-bernoulli DropEdge with ARM(BBDE-ARM)</li>
    </ul>

    <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/16.png" alt="" /></p>

    <p>-&gt; 최적화한 Dropout rate를 Dropout 방식, Dropedge 방식, GDC 방식 모두에 적용해봤을 때 GDC가 최고의 성능을 달성했다.</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>실험 3 : Dropout 방식에 따른 불확실성 측정 결과</strong></p>

    <blockquote>
      <p>Base linde : GCN-DO</p>

      <p>Metric : Patch Accuracy vs Patch Uncertainty(PAvPU)(Mukhoti &amp; Gal, 2018)</p>
    </blockquote>

    <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/17.png" alt="" /></p>

    <p>-&gt; PAvPU의 값이 높을수록 예측이 잘 맞다. 즉, GCN-BBGDC가 모든 Threshold에서 높은 성과를 내고 있음을 확인할 수 있다.</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>실험 4 : Dropout 방식에 따른 과적합 및 Over-fitting 방지 효과 확인</strong></p>

    <blockquote>
      <p>Baseline : GCN-DO</p>

      <p>Metric : Total variation(TV). TV 은 smoothness를 측정한다(Chen et al., 2015). TV 수치가 낮아질수록 over-smoothing 을 의미한다.</p>
    </blockquote>

    <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/18.png" alt="" /></p>

    <p>-&gt; GCN-DO는 학습 횟수(epoch)가 증가함에 따라 첫번째 hidden 층에선 TV가 조금씩 증가하고, 둘째 층에선 TV가 줄어든다. 반면 GCN-BBGDC는 에포크가 증가함에 따라 첫째, 둘째 hidden 층에서 TV가 증가한다. 이러한 차이는 hidden 레이어 층의 개수를 늘렸을 때, GCD-DO는 성능이 악화되지만 GCN-BBGDC는 그렇지 않은 이유를 설명해준다. GDC의 구조 뿐만 아니라 Droprate의 Adaptive learning이 BBGDC 방법의 강건성을 제공한다.</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>실험 5 : GDC 방법 간 Block 적용에 따른 영향 확인</strong></p>

    <ul>
      <li>GDC는 모든 input, output 특징 간에 개별적인 Mask를 고려하기 때문에 많은 메모리 용량을 필요로 한다. 하나의 해결 방법으로 특징들을 Block 화한다면 필요로 하는 메모리 양을 줄일 수 있다. Block에 따른 성능에 미치는 영향을 확인한다.</li>
    </ul>

    <p><img src="../../images/Bayesian_Graph_Neural_Network_with_Adaptive_Connection_Sampling/19.png" alt="" /></p>

    <p>-&gt; Block의 수가 늘어날 수록 정확도가 향상된다. 즉, Block의 개수를 정하는 것은 모델의 성능과 메모리 사용량을 Trade-off하는 요인임을 확인할 수 있다.</p>

    <p><br /></p>
  </li>
</ul>

<h4 id="5-결론">5. 결론</h4>

<ul>
  <li>
    <p>본 연구는 GNN에 BNN을 적용한다. 기존에도 GNN에 BNN을 적용하려는 시도가 있었으나, 계산양이 많고 Graph의 구조적 정보만을 반영하여 한계가 많았다. 반면 본 연구의 모델은 GDC 방법을 통해 그래프의 노드 정보까지 반영한다는 점, Sampling 기반으로 evidence form을 계산함으로써 계산양을 줄여냈다는 점에서 차별점을 가진다.</p>
  </li>
  <li>
    <p>본 연구는 기존의 Dropout 방법을 일반화한 GDC 방법을 제안한다. 기존 연구에서 Dropout과 Dropedge 모델을 함께 사용했을 때 과적합 및 Oversmoothing 문제를 해소할 수 있었다. 본 연구에서는 GDC를 최적화함으로써 보다 효율적으로 과적합 및 Oversmoothing을 막을 수 있음을 보인다.</p>
  </li>
  <li>
    <p>본 연구는 Dropout rate을 모델링함으로써 주어진 데이터 셋에 대해 최적화한다.  최적화된 Dropout rate는 모델의 성능을 향상시키며, GDC 모델에 적용했을 때 성능이 가장 좋았다.</p>
  </li>
</ul>

<p><br /></p>

<hr />

<h5 id="posting-author-information">Posting author information</h5>

<ul>
  <li>
    <p>강현구 (Hyeongu Kang)</p>

    <ul>
      <li>
        <p>GSDS at KAIST</p>
      </li>
      <li>
        <p>Machine learning method, Active learning, Semi-supervised learning</p>
      </li>
      <li>
        <p><a href="https://github.com/gusrn0505">GitHub</a></p>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="6-참고-논문-및-추가-자료">6. 참고 논문 및 추가 자료</h3>

<ul>
  <li>
    <p>Reference</p>

    <ul>
      <li>
        <p>Boluki, S., Ardywibowo, R., Dadaneh, S. Z., Zhou, M., and Qian, X. Learnable Bernoulli dropout for Bayesian deep learning. In Proceedings of the Twenty Third International Conference on Artificial Intelligence and Statistics,
pp. 3905–3916, 2020.</p>
      </li>
      <li>
        <p>Chen, S., Sandryhaila, A., Moura, J. M., and Kovacevic, J.Signal recovery on graphs: Variation minimization. IEEE
Transactions on Signal Processing, 63(17):4609–4624, 2015.</p>

        <p>Gal, Y. and Ghahramani, Z. Bayesian convolutional neural networks with bernoulli approximate variational inferrence. arXiv preprint arXiv:1506.02158, 2015.</p>
      </li>
      <li>
        <p>Gal, Y., Hron, J., and Kendall, A. Concrete dropout. In Advances in neural information processing systems, pp. 3581–3590, 2017</p>

        <p>Ghahramani, Z. and Griffiths, T. L. Infinite latent feature models and the Indian buffet process. In Advances in neural information processing systems, pp. 475–482, 2006.</p>
      </li>
      <li>
        <p>Hajiramezanali, E., Dadaneh, S. Z., Karbalayghareh, A., Zhou, M., and Qian, X. Bayesian multi-domain learning for cancer subtype discovery from next-generation sequencing count data. In Advances in Neural Information
Processing Systems, pp. 9115–9124, 2018.</p>
      </li>
      <li>
        <p>Jang, E., Gu, S., and Poole, B. Categorical reparameterization with gumbel-softmax. arXiv preprint arXiv:1611.01144, 2016.</p>
      </li>
      <li>
        <p>Mukhoti, J. and Gal, Y. Evaluating bayesian deep learning methods for semantic segmentation. arXiv preprint arXiv:1811.12709, 2018.</p>
      </li>
      <li>
        <p>Rong, Y., Huang, W., Xu, T., and Huang, J. DropEdge: Towards the very deep graph convolutional networks for node classification, 2019.</p>
      </li>
      <li>
        <p>Kumaraswamy, P. A generalized probability density function for double-bounded random processes. Journal of Uin et al., 2020)</p>
      </li>
      <li>
        <p>Yin, M. and Zhou, M. ARM: Augment-REINFORCEmerge gradient for stochastic binary networks. In International Conference on Learning Representations, 2019.</p>
      </li>
      <li>
        <p>Zhang, Y., Pal, S., Coates, M., and Ustebay, D. Bayesian graph convolutional neural networks for semi-supervised classification. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 33, pp. 5829–5836, 2019.</p>
      </li>
      <li>
        <p>Zhou, M., Chen, H., Ren, L., Sapiro, G., Carin, L., and Paisley, J. W. Non-parametric Bayesian dictionary learning for sparse image representations. In Advances in neural information processing systems, pp. 2295–2303, 2009</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Github : https://github.com/armanihm/GDC</p>
  </li>
</ul>

    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2023 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Nov 24, 2023 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>



<!DOCTYPE html>
<html>
<head>
    <meta name="google-site-verification" content="1tAPTdgw0-t8G2Bya463OpBtYUbj9Um93gfnsowYKLw" />
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[ESWA 2023] ProMIL: A weakly supervised multiple instance learning for whole slide image classification based on class proxy | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://localhost:4000/feed.xml">


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>




    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS535_2023.html">DS535 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2024.html">DS503 (2024)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [ESWA 2023] ProMIL: A weakly supervised multiple instance learning for whole slide image classification based on class proxy page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[ESWA 2023] ProMIL: A weakly supervised multiple instance learning for whole slide image classification based on class proxy">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
          
          
          <li><a title="DS535 (2023F)" href="reviews_DS535_2023.html">DS535 (2023F)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[ESWA 2023] ProMIL: A weakly supervised multiple instance learning for whole slide image classification based on class proxy</h1>
        <p class="post-meta"><time datetime="2024-04-17T00:00:00+09:00" itemprop="datePublished">Apr 17, 2024</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h1 id="bag-level-label-ì˜ˆì¸¡ì„-ìœ„í•œ-ìƒˆë¡œìš´-ë°©ë²•ë¡ ì—-ëŒ€í•˜ì—¬">Bag level label ì˜ˆì¸¡ì„ ìœ„í•œ ìƒˆë¡œìš´ ë°©ë²•ë¡ ì— ëŒ€í•˜ì—¬</h1>

<h2 id="1-problem-definition">1. Problem Definition</h2>
<p>â€ƒWSI(Whole Slide Image)ëŠ” ì§ˆë³‘ ì§„ë‹¨, ë³‘ë¦¬í•™ ì—°êµ¬ ë“±ì—ì„œ ì¡°ì§ì˜ ì‹œê°í™”ì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” giga pixel ë‹¨ìœ„ì˜ ì´ë¯¸ì§€ì´ë‹¤. í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ëª¨ë¸ì´ í•™ìŠµí•˜ì—¬ ë‹¤ì–‘í•œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” WSIë¥¼ ì‘ì€ patchë“¤ë¡œ ë‚˜ëˆ„ëŠ” patching ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ë˜í•œ, ë³‘ë¦¬í•™ìë“¤ì— ì˜í•œ localized annoationì´ í•„ìš”í•˜ë‚˜, ì´ëŠ” ë§ì€ ì‹œê°„ê³¼ ë¹„ìš©ì„ ì†Œëª¨í•œë‹¤. ë”°ë¼ì„œ, patch levelì—ì„œì˜ lable ì—†ì´ Slide(WSI) ë‹¨ìœ„ì˜ label ë§Œì„ í™œìš©í•˜ì—¬ WSIì˜ ë²”ì£¼ë¥¼ ë¶„ë¥˜í•˜ëŠ” weakly supervised learningì˜ í•„ìš”ì„±ì´ ë¶€ê°ëœë‹¤. ë³¸ ë…¼ë¬¸ì€ class proxyë¥¼ í™œìš©í•˜ì—¬ WSIì— ëŒ€í•œ weakly supervised learningì„ ë³´ë‹¤ íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ë°©ì•ˆì„ ì œì‹œí•œë‹¤.</p>

<h2 id="2-motivation">2. Motivation</h2>
<p>â€ƒMultiple Instance Learning(MIL)ì€ WSIì™€ ê°™ì€ ê³ í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° íš¨ê³¼ì ì¸ ëª¨ë¸ì´ë‹¤. í•´ë‹¹ ëª¨ë¸ì€ feature extractor, aggregator, classifierë¡œ ì´ë£¨ì–´ì ¸ ì‘ì€ patchë“¤ë¡œë¶€í„° featureë¥¼ ì¶”ì¶œí•˜ì—¬ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ embeddingì„ ìˆ˜í–‰í•˜ê³ , WSIì˜ ë²”ì£¼ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜, ê¸°ì¡´ conventional MILì€ 1ì¥ì—ì„œ ì–¸ê¸‰í•œ ë°”ì™€ ê°™ì´ patch level labelì„ í•„ìš”ë¡œ í•˜ë©°, ë²”ì£¼ ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ”ë° ì–´ë ¤ì›€ì„ ì§€ë‹Œë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•˜ì—¬ ë‹¤ì–‘í•œ ì‹œë„ê°€ ì´ë£¨ì–´ì¡Œìœ¼ë‚˜, ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ì ì„ ì§€ë‹Œë‹¤.</p>

<p><a href="https://arxiv.org/abs/2011.08939">DS-MIL(CVPR 2021)</a>: Dual streamì„ ë„ì…í•˜ì—¬ ì¤‘ìš”í•œ patchë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ predictionì€ ìˆ˜í–‰í•œë‹¤. 1st streamì€ max-poolingì„ í™œìš©í•˜ì—¬ informative patchë¥¼ ì‹ë³„í•˜ë©°, 2nd streamì€ ê° patchì— ëŒ€í•œ attention scoreë¥¼ ê³„ì‚°í•˜ì—¬ predictionì„ ìˆ˜í–‰í•œë‹¤. ê·¸ëŸ¬ë‚˜, DS-MILì€ spatial featureë¥¼ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤ëŠ” í•œê³„ì ì„ ì§€ë‹Œë‹¤.</p>

<p><a href="https://arxiv.org/abs/2203.12081">DTFD-MIL(CVPR 2022)</a>: WSI levelì—ì„œì˜ ì •ë³´ë§Œ ì¡´ì¬í•  ë¿, patch levelì˜ ì •ë³´ëŠ” ì¡´ì¬í•˜ì§€ ì•Šê¸°ì—, pseudo-bagì„ ë„ì…í•˜ì—¬ # of bagë¥¼ ëŠ˜ë¦¬ê³ , ê²°ê³¼ì ìœ¼ë¡œ ë™ì¼í•œ ë°ì´í„°ë¡œë¶€í„° ë³´ë‹¤ ë§ì€ ì •ë³´ë¥¼ ì–»ê³ ì ì‹œë„í•œë‹¤. T1 ë‹¨ê³„ì—ì„œ ê° pseudo-bagì˜ representationì„ ì˜ˆì¸¡í•˜ê³ , T2 ë‹¨ê³„ì—ì„œëŠ” T1 ë‹¨ê³„ì—ì„œì˜ ì •ë³´ë¥¼ ë°˜ì˜í•˜ì—¬ WSI levelì˜ predictionì„ ìˆ˜í–‰í•œë‹¤. ê·¸ëŸ¬ë‚˜, DTFD-MILì€ pseudo-bagì˜ ìˆ˜ë¥¼ ì‹¤í—˜ì ìœ¼ë¡œ ê²°ì •í•´ì•¼ í•˜ë©°, label noiseì— ë¯¼ê°í•˜ë‹¤ëŠ” í•œê³„ì ì„ ì§€ë‹Œë‹¤.</p>

<h2 id="3-method">3. Method</h2>
<p>â€ƒê¸°ì¡´ì˜ conventional MILê³¼ DS-MIL, DTFD-MIL ë“±ì„ ë³´ì™„í•˜ì—¬ ë³¸ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ProMILì€ patch levelì˜ annotation ì—†ì´ class proxyë¥¼ í†µí•´ ê° ë²”ì£¼ì˜ íŠ¹ì„±ì„ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” representativeí•œ vectorë¥¼ ì°¾ê³ , ì´ë¥¼ í™œìš©í•˜ì—¬ WSIì˜ class labelì„ ì˜ˆì¸¡í•˜ëŠ” weakly supervised learning + metric learning ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤. Fig.1ì€ ê¸°ì¡´ì˜ ë°©ë²•ë¡ ê³¼ ProMILì˜ êµ¬ì¡°ì ì¸ ì°¨ì´ë¥¼ ê°„ëµí•˜ê²Œ í‘œí˜„í•œë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig1.jpg" alt="alt text" />
  <br />
  <em>Fig.1. Illustration of the difference between ProMIL and conventional MIL models</em>
</p>

<h3 id="31-metric-learning">3.1 Metric Learning</h3>
<p>â€ƒWeakly supervised learningê³¼ëŠ” ë‹¬ë¦¬ í•„ìì—ê²Œ metric learningì€ ë‹¤ì†Œ ìƒì†Œí•œ ê´€ê³„ë¡œ ë³¸ ë…¼ë¬¸ì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œ metric learningì— ëŒ€í•´ ê°„ëµíˆ ë‹¤ë£¨ê³ ì í•œë‹¤. ê¸°ì¡´ì˜ featureë¡œëŠ” ë¶„ë¥˜ê°€ ì‰½ì§€ ì•Šì•˜ë˜ ë°ì´í„°ì— ëŒ€í•´ ë°ì´í„°ë¥¼ class label ë³„ë¡œ ì˜ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” metricì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì„ ì˜ë¯¸í•œë‹¤. Fig.2ëŠ” ì´ëŸ¬í•œ ê´€ì ì—ì„œ metric learningì˜ ëª©ì ì„ ì‹œê°ì ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig2.png" alt="alt text" />
  <br />
  <em>Fig.2. Illustration of purpose for metric learning</em>
</p>

<p>â€ƒê¸°ì¡´ì˜ classification taskì™€ëŠ” ë‹¤ë¥´ê²Œ metric learningì€ íŠ¹íˆ imbalance datasetì—ì„œ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤. ë¶„ë¥˜ ë¬¸ì œëŠ” â€œ$x$ëŠ” $y$ì´ë‹¤.â€ë¼ëŠ” ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë©´, metric learningì€ â€œ$x_1$ì€ $x_2$ì™€ëŠ” ê°€ê¹ê³ , $x_3$ì™€ëŠ” ë©€ë‹¤.â€ë¼ëŠ” ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•˜ê¸°ì— ë³´ë‹¤ sparseí•œ labelì— ëŒ€í•´ì„œë„ ë‹¤ë¥¸ class labelë¡œë¶€í„° ë©€ë¦¬ ë–¨ì–´ì§€ê²Œë” í•™ìŠµì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ê°™ì€ classë¼ë¦¬ëŠ” ê°€ê¹ê²Œ, ë‹¤ë¥¸ classë¼ë¦¬ëŠ” ë©€ê²Œë¼ëŠ” ì†Œê¸° ëª©ì ì˜ ì ˆë°˜ì€ ë‹¬ì„±í•œ ì…ˆì´ë‹¤.</p>

<p>â€ƒMetric learningì„ í†µí•´ í•™ìŠµëœ ìƒˆë¡œìš´ ê±°ë¦¬ í•¨ìˆ˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ embedding function $ğ‘“: â„^ğ‘Ÿâ†’â„^ğ‘š$ë¥¼ í†µí•´ ë³€í™˜ëœ ìƒˆë¡œìš´ ë°ì´í„° í‘œí˜„ì— ëŒ€í•œ Euclidean distanceë¡œ ì •ì˜ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, metric learningì„ í†µí•´ í•™ìŠµëœ ê±°ë¦¬ í•¨ìˆ˜ë¥¼ ğ‘“(ğ‘¥;ğœƒ)ë¼ê³  í•  ë•Œ, ë‘ ë°ì´í„° $ğ’™_ğŸ$ê³¼ $ğ’™_2$ì— ëŒ€í•œ ìƒˆë¡œìš´ ê±°ë¦¬ í•¨ìˆ˜ $d(ğ’™_ğŸ, ğ’™_2)$ëŠ” ì•„ë˜ì™€ ê°™ì´ ì •ì˜ëœë‹¤. ë”°ë¼ì„œ, metric learning ë¬¸ì œì˜ ëª©ì ì€ ë°ì´í„°ë¥¼ ê° ëª©í‘œê°’ì— ë”°ë¼ ì˜ êµ¬ë¶„ë˜ë„ë¡ ë³€í™˜í•˜ëŠ” embedding í•¨ìˆ˜ ğ‘“ë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì´ ëœë‹¤. ì´ë–„, ğ‘“ê°€ ë‹¨ìˆœí•œ ì„ í˜• ë³€í™˜ì´ ì•„ë‹ˆë¼, deep neural networkì¼ ê²½ìš°ì— ì•ì— deepì„ ë¶™ì—¬ deep metric learningì´ë¼ê³  í•œë‹¤.</p>

<p>$d(ğ’™_ğŸ, ğ’™_2)=\vert\vert f(ğ’™_ğŸ)-f(ğ’™_2)\vert\vert^2_2$</p>

<p>â€ƒDeep metric learningì—ëŠ” contrastive loss, triplet loss ë“± ë‹¤ì–‘í•œ loss functionì— ê¸°ë°˜í•œ ë°©ë²•ì´ ìˆì§€ë§Œ, ì´ëŠ” sampling, calculation issueë¥¼ ì§€ë‹ˆë¯€ë¡œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” class proxy, ì¦‰ ê° í´ë˜ìŠ¤ë¥¼ ê°€ì¥ ì˜ ëŒ€í‘œí•˜ëŠ” vectorë¥¼ ì°¾ê¸° ìœ„í•œ  NCA lossë¥¼ ì‚¬ìš©í•˜ì˜€ìŒì„ ë°íŒë‹¤. ì´ë•Œ, NCA lossëŠ” sample vectorì™€ proxy vectorë¥¼ ìµœëŒ€í•œ ê°€ê¹ê²Œ ë§Œë“œëŠ”ë° ëª©ì ì„ ë‘ë©°, ëª¨ë“  sample set $Z$ì™€ sample vector $x$, proxy vector $y$ì— ëŒ€í•´ì„œ ì•„ë˜ì™€ ê°™ì´ ì •ì˜ëœë‹¤.</p>

<p>$L_{NCA}(x, y, Z) = -\log \left( \frac{\exp(-d(x, y))}{\sum_{z \in Z} \exp(-d(x, z))} \right)$</p>

<h3 id="32-overall-framework">3.2 Overall Framework</h3>
<p>â€ƒProMIL ëª¨ë¸ì˜ overall frameworkëŠ” Fig.3.ì— ì œì‹œëœë‹¤. Patching(preprocessing) ê³¼ì •ì„ ê±°ì¹œ WSI ë°ì´í„°ì— ëŒ€í•˜ì—¬ í•´ë‹¹ ëª¨ë¸ì˜ ì£¼ìš” workflowëŠ” 2ê°œ ë¶„ê¸°ë¥¼ í¬í•¨í•œë‹¤. ìƒìœ„ ë¶„ê¸°ì—ì„œëŠ” ê° WSI embedding ê³¼ì •ì„, í•˜ìœ„ ë¶„ê¸°ì—ì„œëŠ” class proxy í•™ìŠµ ê³¼ì •ì„ ê±°ì¹˜ë©°, ê²°ê³¼ì ìœ¼ë¡œ, embedding vectorì™€ proxy vector ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ NCA loss functionì„ í™œìš©í•˜ì—¬ ëª¨ë¸ íŒŒë¼ë¯¸í„°ì™€ class proxyê°€ ì—…ë°ì´íŠ¸ëœë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig3.jpg" alt="alt text" />
  <br />
  <em>Fig.3. Illustration of ProMIL's overall framework</em>
</p>

<h3 id="33-preprocessing">3.3 Preprocessing</h3>
<p>â€ƒWSIì—ëŠ” trainingê³¼ inferenceì— ì˜ë¯¸ì—†ëŠ” background areaê°€ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ, RGBë¡œë¶€í„° HSV color spaceë¡œ ë³€í™˜ëœ ì´ë¯¸ì§€ì˜ í¬í™”ë„ ê°’ê³¼ ì„ê³„ê°’ì„ ë¹„êµí•˜ì—¬ ì¡°ì§ ì˜ì—­ì˜ binary maskë¥¼ ìƒì„±í•œë‹¤. ì´í›„, blurringê³¼ morphological closingì„ í†µí•´ tissue extractionì„ ìˆ˜í–‰í•œë‹¤. ê·¸ëŸ¬ë‚˜, ì¶”ì¶œëœ ì¡°ì§ ì˜ì—­ ë˜í•œ ì»´í“¨í„°ê°€ ì²˜ë¦¬í•˜ê¸°ì— ë§¤ìš° í¬ê¸°ì— ì§ì ‘ í›ˆë ¨ì— ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ patchë¡œ ë¶„í• í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” WSIë¥¼ 224x224 í¬ê¸°ì˜ ì¼ë ¨ì˜ íŒ¨ì¹˜ë¡œ ìë¥¸ë‹¤. ê·¸ ê²°ê³¼, Fig.4.ì˜ (c)ì™€ ê°™ì€ Patchingì„ ì™„ë£Œí•œ tissue regionì„ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig4.jpg" alt="alt text" />
  <br />
  <em>Fig.4. Illustration of preprocessing WSI</em>
</p>

<h3 id="34-wsi-embedding">3.4 WSI Embedding</h3>
<p>â€ƒì•ì„œ 3.3ì¥ì˜ preprocessingì„ ë§ˆì¹œ WSIëŠ” multi-scale feature generator (MSFG)ì— ì˜í•´ ê°œì²´ë³„ë¡œ representation matrix $R$ì´ ìƒì„±ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, $i$ë²ˆì§¸ WSIì˜ $j$ë²ˆì§¸ patch $x_{i,j}$ëŠ” pretrained ResNet101ì˜ stage3 ($S_3$) &amp; stage4 ($S_4$)ë¥¼ ê±°ì³ ê°ì ë‹¤ë¥¸ í¬ê¸°ì˜ ì°¨ì› $l_3, l_4$ë¥¼ ì§€ë‹ˆëŠ” features $s_{i,j}^3, s_{i,j}^4$ê°€ ì¶”ì¶œëœë‹¤. <br />
\(s_{i,j}^3=S_3(x_{i,j}), s_{i,j}^4=S_4(x_{i,j})\) <br />
\(s_{i,j}^3 \in \mathbb{R}^{1 \times l_3}, s_{i,j}^4 \in \mathbb{R}^{1 \times l_4}\)</p>

<p>â€ƒ\(s^3_{i,j},s^4_{i,j}\) ëŠ” concatenateë˜ì–´ $i$th WSIâ€™s $j$th patch $x_{i,j}$ì— ëŒ€í•œ representation vector $r_{i,j}$ê°€ ìƒì„±ë˜ê³  $i$th WSIì— ëŒ€í•˜ì—¬ $n_i$ê°œì˜ patch representation vectorë¥¼ í† ëŒ€ë¡œ representation matrix $R_i$ ê°€ ìƒì„±ëœë‹¤. ì´ë•Œ $z$ëŠ” concat featureì˜ ì°¨ì›ì„ ì˜ë¯¸í•œë‹¤.
\(r_{i,j}=concat([s^3_{i,j},s^4_{i,j}]), \quad r_{i,j} \in \mathbb{R}^{1 \times z}\) <br />
\(R_i = \{ r_{i,1}, r_{i,2}, \ldots, r_{i,n_i} \}, \quad R_i \in \mathbb{R}^{n_i \times z}\)</p>

<p>â€ƒ$i$th WSIâ€™s representation matrix $R_i$ì— ëŒ€í•˜ì—¬ batch normalization, projection, activation, regularizationì„ ê±°ì³ WSIë³„ë¡œ matrix \(H'_i\)ì™€ patchë³„ë¡œ vector \(h'_{i,j}\)ê°€ ìƒì„±ëœë‹¤. ì´ë•Œ, \(W_p\)ëŠ” projection matrixë¥¼ ì˜ë¯¸í•œë‹¤.
\(R'_i=BatchNormald(R_i)\)
\(H^T_i=Relu(W_pR'^T_i), \quad W_p \in \mathbb{R}^{d \times z}\)
\(H'_i=L2-Norm(H_i), \quad H'_i \in \mathbb{R}^{n_i \times d}\)
\(H_i' = \{ h_{i,1}', \ldots, h_{i,n_i}' \}, \quad h_{i,j}' \in \mathbb{R}^{1 \times d}\)</p>

<p>â€ƒpatchë³„ vector $hâ€™_{i,j}$ëŠ” <a href="https://proceedings.mlr.press/v80/ilse18a.html?ref=https://githubhelp.com">Gated-Attention (Ilse et al., 2018)</a>ì„ í†µí•´ attention score ê³„ì‚°, dropout, weighted aggregationì„ ê±°ì³ $i$th WSI embedding $G_i$ë¥¼ outputìœ¼ë¡œ ë„ì¶œí•˜ê²Œ ëœë‹¤.</p>

<p>\(a_{i,j} = \frac{\exp{ \left( W_a \left( \tanh \left( V_a h_{i,j}' \right)^T \right) \odot \sigma \left( U_a h_{i,j}' \right)^T \right) }}{\sum_{p=1}^{n_i} \exp{ \left( W_a \left( \tanh \left( V_a h_{i,p}' \right)^T \right) \odot \sigma \left( U_a h_{i,p}' \right)^T \right) }}\)
\(\{ a_{i,1}', \ldots, a_{i,n_i}' \} = \text{dropout}(a_{i,1}, \ldots, a_{i,n_i})\)
\(G_i = \sum_{j=1}^{n_i} a_{i,j}' h_{i,j}'\)
Fig.5ëŠ” preprocessingë¶€í„° feature extraction, projection, gated attention ë“± WSI Embeddingì˜ ì „ì²´ì ì¸ ê³¼ì •ì„ ë³´ì—¬ì¤€ë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig5.jpg" alt="alt text" />
  <br />
  <em>Fig.5. Illustration of WSI embedding overflow</em>
</p>

<h3 id="35-class-proxy-construction">3.5 Class Proxy Construction</h3>
<p>â€ƒê° classë¥¼ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” vector, class proxyëŠ” randomí•˜ê²Œ initialized ë˜ì–´, 3.4ì¥ì—ì„œ ë„ì¶œí•œ WSI embedding $G_i$ì™€ì˜ ì°¨ì´ë¥¼ minimizeí•˜ëŠ” ë°©í–¥ìœ¼ë¡œ $T$ epoch ë™ì•ˆ í•™ìŠµ ê³¼ì •ì—ì„œ update ëœë‹¤. ì´ë•Œ, cosine simliarity $\cos \theta_c$ë¥¼ ë°”íƒ•ìœ¼ë¡œ embedding vectorì™€ proxy vectorì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•œë‹¤. ì¦‰, ProMIL ëª¨ë¸ì€ $distance=-\cos \theta_c$ë¼ê³  ì •ì˜í•˜ë©° $\cos \theta_c$ëŠ” ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

<p>\(p_c^1 \in \mathbb{R}^{1 \times d}, \quad c \in \{0, \ldots, C-1\}\)
\(\cos \theta_c = \left&lt; \frac{G_i}{\| G_i \|_2}, \frac{p_c^t}{\| p_c^t \|_2} \right&gt;, \quad t=1, \ldots, T\)</p>

<h3 id="36-loss-function">3.6 Loss Function</h3>
<p>â€ƒì•ì„œ 3.1ì¥ì—ì„œ class proxyë¥¼ ì˜ í•™ìŠµí•˜ê¸° ìœ„í•œ NCA lossì— ëŒ€í•´ ê°„ëµíˆ ë‹¤ë£¨ì—ˆë‹¤. ë³¸ ë…¼ë¬¸, ProMILì˜ loss function $Lossâ€™$ì€ NCA lossì— marginì„ ì¶”ê°€í•˜ì—¬ ë³´ë‹¤ informativeí•œ instances(pathces)ì— ë” ë§ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ë„ë¡ í•˜ì˜€ë‹¤. ë˜í•œ, {ğ, ğ’, ğ’”} í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•˜ì—¬ ê°ê° ëª¨ë¸ì˜ overfitting ë°©ì§€, cosine marginì˜ í¬ê¸° í†µì œ, ëª¨ë¸ ìˆ˜ë ´ ì†ë„ í–¥ìƒì˜ ëª©ì ì„ ë‹¬ì„±í•˜ê³ ì ì‹œë„í•˜ì˜€ë‹¤.
\(Loss' = (1 - \alpha + \frac{\alpha}{C})Loss - \frac{\alpha}{C} \sum_{c=0, c \neq Y_i}^{C-1} \log \left( \frac{e^{s \cdot \cos \theta_c}}{e^{s \cdot (\cos \theta_{Y_i} - m)} + \sum_{c=0, c \neq Y_i}^{C-1} e^{s \cdot \cos \theta_c}} \right)\)
\(Loss = -\log \left( \frac{e^{s \cdot (\cos \theta_{Y_i} - m)}}{e^{s \cdot (\cos \theta_{Y_i} - m)} + \sum_{c=0, c \neq Y_i}^{C-1} e^{s \cdot \cos \theta_c}} \right), \quad \alpha (0 &lt; \alpha &lt; 1), m \geq 0, s \geq 0\)</p>

<h3 id="37-algorithm">3.7 Algorithm</h3>
<p>â€ƒ Fig.6ëŠ” ProMIL ëª¨ë¸ì˜ pseudo codeë¥¼ ì œì‹œí•œë‹¤. í•´ë‹¹ ì½”ë“œëŠ” WSI embedding, simliarity measure, bag prediction, gradient calculation, parameter update ê³¼ì • ë“±ì„ í¬í•¨í•œë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig6.jpg" alt="alt text" />
  <br />
  <em>Fig.6. Model Algorithm</em>
</p>

<h2 id="4-experiment">4. Experiment</h2>
<p>â€ƒë³¸ ì¥ì—ì„œëŠ” ProMIL ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í‰ê°€í•˜ê¸° ìœ„í•´ 6ê°œì˜ (CAMELYON16, TCGA-NSCLC, TCGA-RCC, HER2-Status, Trastuzumab response, Breakhis-2 (binary), Breakhis-8 (multi-class)) open-source datasetì— ëŒ€í•´ ì‹¤í—˜ì„ ì§„í–‰í•˜ì˜€ë‹¤. ê·¸ ê²°ê³¼, ProMIL ëª¨ë¸ì´ ê¸°ì¡´ ëª¨ë¸ DS-MIL, Trans-MIL, DTFD-MIL ë“±ì— ë¹„í•´ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì‹¤í—˜ ê²°ê³¼ëŠ” Table.1, Table.2, Table.3ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Method</th>
      <th style="text-align: center">CAMELYON16 Accuracy</th>
      <th style="text-align: center">CAMELYON16 AUC</th>
      <th style="text-align: center">TCGA-NSCLC Accuracy</th>
      <th style="text-align: center">TCGA-NSCLC AUC</th>
      <th style="text-align: center">TCGA-RCC Accuracy</th>
      <th style="text-align: center">TCGA-RCC AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ABMIL</td>
      <td style="text-align: center">0.845</td>
      <td style="text-align: center">0.854</td>
      <td style="text-align: center">0.869</td>
      <td style="text-align: center">0.941</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">MIL-RNN</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.930</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">DSMIL</td>
      <td style="text-align: center">0.8682</td>
      <td style="text-align: center">0.894</td>
      <td style="text-align: center">0.9190</td>
      <td style="text-align: center">0.9633</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">CLAM</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.936</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.963</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.991</td>
    </tr>
    <tr>
      <td style="text-align: center">TransMIL</td>
      <td style="text-align: center">0.8837</td>
      <td style="text-align: center">0.9309</td>
      <td style="text-align: center">0.8835</td>
      <td style="text-align: center">0.9603</td>
      <td style="text-align: center">0.9466</td>
      <td style="text-align: center">0.9882</td>
    </tr>
    <tr>
      <td style="text-align: center">DTFD-MIL</td>
      <td style="text-align: center">0.908</td>
      <td style="text-align: center">0.946</td>
      <td style="text-align: center">0.894</td>
      <td style="text-align: center">0.961</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">ProMIL</td>
      <td style="text-align: center">0.9132</td>
      <td style="text-align: center">0.8991</td>
      <td style="text-align: center">0.9814</td>
      <td style="text-align: center">0.9942</td>
      <td style="text-align: center">0.9938</td>
      <td style="text-align: center">0.9968</td>
    </tr>
  </tbody>
</table>

<p>Table.1. Experimental results on CAMELYON16, TCGA-NSCLC and TCGA-RCC</p>

<p>Â </p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Status</th>
      <th style="text-align: center">HER2-Status Accuracy</th>
      <th style="text-align: center">HER2-Status AUC</th>
      <th style="text-align: center">Trastuzumab response Accuracy</th>
      <th style="text-align: center">Trastuzumab response AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Unannotated</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.82</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.68</td>
    </tr>
    <tr>
      <td style="text-align: center">Annotated</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.90</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.80</td>
    </tr>
    <tr>
      <td style="text-align: center">ProMIL</td>
      <td style="text-align: center">0.9489</td>
      <td style="text-align: center">0.9614</td>
      <td style="text-align: center">0.9176</td>
      <td style="text-align: center">0.9210</td>
    </tr>
  </tbody>
</table>

<p>Table.2. Experimental results on HER2-Status and Trastuzumab response</p>

<p>Â </p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Model</th>
      <th style="text-align: center">Binary Accuracy</th>
      <th style="text-align: center">Binary AUC</th>
      <th style="text-align: center">Multi-class Accuracy</th>
      <th style="text-align: center">Multi-class AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CSDCNN-Raw</td>
      <td style="text-align: center">0.9580</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.894</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">INV3-Raw</td>
      <td style="text-align: center">0.9684</td>
      <td style="text-align: center">0.9947</td>
      <td style="text-align: center">0.928</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">IRV2-Raw</td>
      <td style="text-align: center">0.9790</td>
      <td style="text-align: center">0.9957</td>
      <td style="text-align: center">0.9207</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">IRV2-Aug</td>
      <td style="text-align: center">0.9716</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0.9763</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">IRRCNN-Raw</td>
      <td style="text-align: center">0.9795</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.9569</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">IRRCNN-Aug</td>
      <td style="text-align: center">0.9799</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">0.9709</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">Sharma et al.</td>
      <td style="text-align: center">0.974</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">C-Net</td>
      <td style="text-align: center">0.9933</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
      <td style="text-align: center">/</td>
    </tr>
    <tr>
      <td style="text-align: center">ProMIL</td>
      <td style="text-align: center">0.9954</td>
      <td style="text-align: center">0.9993</td>
      <td style="text-align: center">0.9640</td>
      <td style="text-align: center">0.9771</td>
    </tr>
  </tbody>
</table>

<p>Table.3. Experimental results on BreakHis</p>

<p>â€ƒì¶”ê°€ì ìœ¼ë¡œ, ë³¸ ë…¼ë¬¸ì—ì„œ í™œìš©í•œ ë‹¤ì–‘í•œ techniqueì˜ ìœ ì˜ì„±ì„ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ visualization ë˜í•œ ìˆ˜í–‰í•˜ì˜€ë‹¤. ê·¸ ê²°ê³¼ëŠ” ì•„ë˜ Fig.7, Fig.8, Fig.9ì™€ ê°™ë‹¤. ë³¸ ëª¨ë¸ì€ class proxyë¥¼ í™œìš©í•˜ì—¬ WSIì˜ class labelì„ ì˜ˆì¸¡í•œë‹¤. Fig.7ì„ í†µí•´ diagonal, ì¦‰ ê°™ì€ classë¼ë¦¬ëŠ” cosine ìœ ì‚¬ë„ê°€ ë†’ì€ ë°˜ë©´, ë‹¤ë¥¸ classë¼ë¦¬ëŠ” ìœ ì‚¬ë„ê°€ ë‚®ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” updateë¥¼ ë§ˆì¹œ class proxyê°€ ê° classì— ëŒ€í•´ representativeí•œ íŠ¹ì„±ì„ ì§€ë‹Œë‹¤ëŠ” ê²ƒì„ ë°˜ì˜í•œë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig7.jpg" alt="alt text" />
  <br />
  <em>Fig.7. Illustration of cosine similarity between class proxies</em>
</p>

<p>ë˜í•œ, ë³¸ ëª¨ë¸ì€ ê¸°ì¡´ conventional MILì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” cross entropy loss fucntion ëŒ€ì‹ , NCA-lossë¥¼ ì‚¬ìš©í•œë‹¤. Fig.8ì€ í•´ë‹¹ loss functionì˜ ìœ ì˜ì„±ì„ ê²€ì¦í•˜ëŠ” ì§€í‘œì´ë‹¤. ê·¸ë˜í”„ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ 6ê°œ open-source datasetì—ì„œ ìœ ì˜ë¯¸í•œ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig8.jpg" alt="alt text" />
  <br />
  <em>Fig. 8. Illustration of the effectiveness of our loss function</em>
</p>

<p>Fig.9ì€ WSIì˜ ê° patchë“¤ì´ ë³¸ ëª¨ë¸ì˜ Gated-Attention ê³¼ì •ì„ ê±°ì³¤ì„ ë•Œ, attention scoreì˜ heatmapì„ ì‹œê°í™”í•œë‹¤. ì‹¤ì œ ë³‘ë¦¬í•™ìë“¤ì˜ patch annotationê³¼ attention heatmapì˜ ìœ ì‚¬í•œ ì–‘ìƒìœ¼ë¡œ ë³´ì•„ ProMIL ëª¨ë¸ì´ model interpretabilityë¥¼ ê°–ì¶˜ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p align="center">
  <img src="../../images/DS503_24S/ProMIL_A_weakly_supervised_multiple_instance_learning_for_whole_slide_image_classification_based_on_class_proxy/Fig9.jpg" alt="alt text" />
  <br />
  <em>Fig.9. Visualization of the attention scores on TCGA-NSCLC, TCGA-RCC and HER2-Status</em>
</p>

<h2 id="5-conclusion">5. Conclusion</h2>
<p>â€ƒ4ì¥ì˜ ì‹¤í—˜ ê²°ê³¼ì— ë”°ë¥´ë©´, ë³¸ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ëª¨ë¸ ProMILì€ ìµœì†Œí•œì˜ annotation (WSI level annotation)ë§Œì„ ë°”íƒ•ìœ¼ë¡œ ê¸°ì¡´ ëª¨ë¸ ëŒ€ë¹„ ë‚˜ì€ ì„±ëŠ¥ì„ ì´ëŒì–´ë‚¸ë‹¤. íŠ¹íˆ, balanced, imbalanced datasetì—ì„œ, binary, multi-class classificationê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìƒí™©ì—ì„œ ì ìš© ê°€ëŠ¥í•œ stabilityê°€ ëª¨ë¸ì˜ ì¥ì ìœ¼ë¡œ ë³´ì¸ë‹¤. ë³¸ ëª¨ë¸ì˜ í™œìš©ì´ ì‹¤ì œ ë³‘ë¦¬í•™ ë¶„ì•¼ì—ì„œì˜ workload ê°ì†Œì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆê¸°ë¥¼ í¬ë§í•œë‹¤.</p>

<h2 id="6-reference">6. Reference</h2>
<p>[1] Ilse, Maximilian, Jakub Tomczak, and Max Welling. â€œAttention-based deep multiple instance learning.â€ International conference on machine learning. PMLR, 2018. <br />
[2] Li, Bin, Yin Li, and Kevin W. Eliceiri. â€œDual-stream multiple instance learning network for whole slide image classification with self-supervised contrastive learning.â€ Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. 2021.  <br />
[3] Movshovitz-Attias, Yair, et al. â€œNo fuss distance metric learning using proxies.â€ Proceedings of the IEEE international conference on computer vision. 2017. <br />
[4] Zhang, Hongrun, et al. â€œDtfd-mil: Double-tier feature distillation multiple instance learning for histopathology whole slide image classification.â€ Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022.</p>

<h2 id="author">Author</h2>
<p>Name: ì†¡ ì°¬ì¬ (ChanJae Song) <br />
Affiliation: KAIST ISE <br />
Contact: chan4535@kaist.ac.kr <br />
Research Topic: Weakly Supervised Learning, Metric Learning</p>

    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2024 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Apr 20, 2024 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>



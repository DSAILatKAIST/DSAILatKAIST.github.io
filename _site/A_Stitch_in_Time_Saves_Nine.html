<!DOCTYPE html>
<html>
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[CVPR 2022] A Stitch in Time Saves Nine | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://localhost:4000/feed.xml">







    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    





</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_DS503_2022.html">DS503 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [CVPR 2022] A Stitch in Time Saves Nine page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[CVPR 2022] A Stitch in Time Saves Nine">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="DS503 (2022S)" href="reviews_DS503_2022.html">DS503 (2022S)</a></li>
          
          
          
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[CVPR 2022] A Stitch in Time Saves Nine</h1>
        <p class="post-meta"><time datetime="2023-04-20T00:00:00+09:00" itemprop="datePublished">Apr 20, 2023</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h1 id="1-introduction">1. Introduction</h1>

<p>현대의 Deep Neural Network (DNN)는 높은 정확도를 보이지만, 예측된 라벨에 대한 confidence score와 실제 발생 확률이 일치하지 않는 miscalibration이 발생한다.
본 논문에서는 ‘Multi-class Difference in Confidence and Accuracy(MDCA)’ 라는 손실 함수를 적용하여 학습 단계에서 calibration 문제를 해결한다.</p>

<h1 id="2-related-work">2. Related Work</h1>
<p>DNN의 calibration 기법으로는 크게 세가지가 존재한다.</p>

<h2 id="1-train-time-calibration">1) Train-Time Calibration</h2>
<p>Negative-Log-Likelihood (NLL) 을 통해 학습된 모델들은 흔히 over-condident 문제가 발생한다. 이를 해결하기 위한 대표적인 방법은 NLL loss에 entropy 와 같은 regularization term을 추가하는 것이다. Label Smoothing(LS), focal loss 또한 흔히 사용된다.</p>

<h2 id="2-post-hoc-calibration">2) Post-Hoc Calibration</h2>
<p>Post-Hoc calibration은 validation set을 사용하는 방법이다. 가장 대표적으로 Temperature scaling(TS)은 validation set을 통해 학습된 스칼라 T로 logit을 나눠 평활화 한다.</p>

<h2 id="3-calibration-through-ood-detection">3) Calibration through OOD Detection</h2>
<p>DNN overconfidence의 가장 큰 이유 중 하나는 학습 데이터의 분포에서 멀리 떨어진 input 샘플에 대해 ReLu 함수이 높은 confidence prediction을 준다는 점이다. 이를 해결하기 위해 adversarial training을 사용한 data augmentation을 통해 학습 데이터와 멀리 떨어진 샘플들에 대해 낮은 confidnece score를 줄 수 있다.</p>

<h1 id="3-methodology">3. Methodology</h1>
<h2 id="background">Background</h2>
<p>$s_i[y]$를 클래스 $y$에 대한 confidence 값이라고 할 때, 예측된 클래스는 다음과 같다.</p>

<p>$\hat{y_i} = arg max_y s_i[y]$</p>

<p>모델이 완벽하게 calibrate 된 경우는 다음과 같이 표현할 수 있다.</p>

<p>$P(y={y}’\vert s[y]=s)=s $</p>

<p>완벽하게 calibrate 되기 위해서는 ReLU 함수를 적용하여 예측된 클래스 외에 다른 클래스에 대해서도 위의 식이 성립해야 하지만, 대부분의 calibration 기법들은 예측 클래스에만 집중한다.</p>

<p>Expected Calibration Error(ECE): ECE는 예측된 클래스의 confidence와 샘플의 정확도(accuracy) 간의 차이에 대한 가중 평균(weighted average)를 통해 계산된다. 
$\sum_{i=1}^{M} B_i/N\left | A_i-C_i \right |$</p>

<p>$N$: 총 샘플의 수</p>

<p>$B_i$: confidence 범위를 M개의 bin으로 분할했을 때, confidence가 $(\frac{i-1}{M}, \frac{i}{M}]$에 포함된 bin의 샘플 수</p>

<p>$A_i$: $B_i$에 포함된 샘플들의 평균 정확도</p>

<p>$C_i$: $B_i$에 포함된 샘플들의 평균 confidence</p>

<p>Maximum Calibration Error(MCE): 각 bin에서의 평균 정확도와 평균 confidence 간 차이의 최댓값. 많이 사용되지 않음.</p>

<p>Static Calibration Error(ECE): 
$\frac{1}{K}\sum_{i=1}^{M}\sum_{j=1}^{K}\frac{B_{i_j}}{N}|A_{i_j}-C_{i_j}|$</p>

<p>$K$: 클래스의 수</p>

<p>$B_{i_j}$: i번째 bin의 j번째 클래스 샘플의 수</p>

<p>$A_{i_j}$: i번째 bin의 j번째 클래스 샘플들의 정확도</p>

<p>$C_{i_j}$: i번째 bin의 j번째 클래스 샘플들의 평균 confidence</p>

<h2 id="proposed-method-mdca">Proposed method: MDCA</h2>
<p>SCE로부터 파생된 손실 함수이지만, 기존에 샘플들을 bin으로 분할함으로 인하여 미분이 불가능하였던 문제를 해결하였다.</p>

<p>$L_ {MDCA} = \frac{1}{K}\sum_ {K}^{j=1}\vert \frac{1}{N_ b}\sum_ {M}^{i=1}s_ i[j] - \frac{1}{N_ b}\sum_ {M}^{i=1}q_ i[j]\vert$</p>

<p>$q_ i[j]=1$(샘플 i에 대한 예측 라벨 j가 ground truth인 경우), $q_ i[j]=0$(그 외)</p>

<p>$N_b$: mini batch에 속한 샘플의 수</p>

<p>MDCA 손실 함수는 미분 가능하기 때문에 다른 손실함수(Cross Entropy, Label Smoothing, Focal Loss 등)와 함께 사용하기에 적합하다.</p>

<p>$L_{total} = L_C +\beta L_{MDCA} $</p>

<h1 id="4-experiment">4. Experiment</h1>

<p>다양한 데이터셋에 기존 SOTA(State-of-the-art) calibration 기법과 MDCA를 함께 적용한 결과를 비교하였다.</p>

<p>CIFAR100 데이터에 MDCA를 적용했을 때 기존 1.90의 ECE score가 0.72로 감소하였다.</p>

<p>그 외에 SVHN, Mendeley V2, Tiny-ImageNet 등의 데이터셋과 자연어 처리에서도 MDCA를 적용한 경우 낮은 calibration error을 나타냈으며, 특히 focal loss와 함께 사용되었을 때 가장 낮은 calibration error을 보였다.</p>

<h1 id="5-conclusion">5. Conclusion</h1>
<p>학습 단계에서 calibration을 위해 사용된 손실함수인 MDCA는 기존 손실함수와 함께 적용했을 때 calibration error을 감소시키는 효과를 보였다. 예측 클래스에만 적용되었던 기존 calibration 기법들과 달리 예측되지 않은 클래스들에 대한 calibration도 달성하였으며, 기존 방법들에서 해결하지 못했던 손실함수의 미분 불가능 문제를 해결함으로써 이러한 성과가 나타났다..</p>

    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2023 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Apr 23, 2023 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>



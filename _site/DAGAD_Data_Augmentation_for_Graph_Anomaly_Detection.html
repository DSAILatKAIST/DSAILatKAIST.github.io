<!DOCTYPE html>
<html>
<head>
    <meta name="google-site-verification" content="1tAPTdgw0-t8G2Bya463OpBtYUbj9Um93gfnsowYKLw" />
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[ICDM 2022] DAGAD: Data Augmentation for Graph Anomaly Detection | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://dsailatkaist.github.io/feed.xml">


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>




    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS535_2023.html">DS535 (2023)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [ICDM 2022] DAGAD: Data Augmentation for Graph Anomaly Detection page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[ICDM 2022] DAGAD: Data Augmentation for Graph Anomaly Detection">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
          
          
          <li><a title="DS535 (2023F)" href="reviews_DS535_2023.html">DS535 (2023F)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[ICDM 2022] DAGAD: Data Augmentation for Graph Anomaly Detection</h1>
        <p class="post-meta"><time datetime="2023-04-20T00:00:00+09:00" itemprop="datePublished">Apr 20, 2023</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h1 id="dagad-data-augmentation-for-graph-anomaly-detection">DAGAD: Data Augmentation for Graph Anomaly Detection</h1>

<h2 id="1-problem-definition"><strong>1. Problem Definition</strong></h2>
<blockquote>
  <p><strong>Classification 등의 downstream task에 악영향을 미치는 anomalous sample을 탐지한다.</strong></p>
</blockquote>

<p>한 그룹 내에서 다른 대다수의 경우와 동떨어진 behavior를 보이는 무언가를 <strong>anomaly</strong>라고 부릅니다. Real-world에서의 예시로는 가짜 뉴스, SNS 상의 허위/스팸 계정, 불법 거래 등이 있습니다. 이러한 real-world scenario는 각각의 data sample(ex. SNS 사용자)을 node로, sample 간의 관계(ex. 팔로우 유무)를 edge로 정의해 <strong>graph data</strong>로 표현할 수 있습니다. Graph data 내에서 real-world anomaly는 anomalous node(ex. 스팸 유저와 같은 single object)나 anomalous edge(ex. 불법 거래와 같은 interaction) 등으로 묘사됩니다. 이 논문은 graph data 속에서 anomalous node를 찾는 <strong>Graph Anomaly Detection</strong> task에 대해 설명합니다.</p>

<p><img src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1007%2Fs10994-021-06044-0/MediaObjects/10994_2021_6044_Fig1_HTML.png" alt="image" /></p>

<p><br /> <br /></p>

<h2 id="2-motivation"><strong>2. Motivation</strong></h2>
<blockquote>
  <p><strong>Graph Anomaly Detection에서 흔히 발생하는 문제를 해결한다.</strong></p>
</blockquote>

<p>Graph anomaly detection(이하 GAD)을 다룬 이전 연구들은 이미 존재하는 graph topological information(node들이 edge로 어떻게 연결되어 있는지에 관한 정보)과 attribute information(node 각각의 정보)을 통해 anomaly를 찾습니다. 하지만 이러한 method는 data에 내재되어 있는 두 가지 문제에 직면합니다.</p>

<p>첫 번째 문제는 <strong>anomalous sample scarcity</strong>입니다. Real-world anomaly에 대한 sample을 얻는 것은 쉬운 일이 아닙니다. 예시로 Alipay라는 결제 사이트에서 피해를 본 사례의 약 90%는 보고되지 않았다고 합니다. 이러한 상황에서 GAD 모델은 적은 양의 anomaly밖에 관측할 수 없습니다.</p>

<p>두 번째 문제는 <strong>class imbalance</strong>입니다. Anomalous sample의 양은 적은 반면 상대적으로 normal(즉 anomaly가 아닌) sample의 양은 훨씬 많은 경우가 대부분입니다. 이 때문에 GAD는 anomaly의 관점에서 굉장히 skewed 된 distribution에서 수행되게 됩니다.</p>

<p>이 두 가지 문제로 인해 이전 연구들은 subpar한 performance를 보입니다. 이를 해결하기 위해 이 논문은 <strong>D</strong>ata <strong>A</strong>ugmentation-based <strong>G</strong>raph <strong>A</strong>nomaly <strong>D</strong>etection framework(DAGAD)을 제안합니다. DAGAD는 <strong>data sample을 추가로 생성해 training set에 추가</strong>하고 <strong>class-wise loss를 통해 학습</strong>하는데, 이 두 방법을 통해 앞서 설명한 두 가지 문제가 끼치는 악영향을 완화할 수 있습니다.</p>

<p><br /> <br /></p>
<h2 id="3-method"><strong>3. Method</strong></h2>
<blockquote>
  <p><strong>Preliminaries</strong></p>
</blockquote>

<p>논문에서 제안한 방법론을 이해하기 위해서 problem formulation을 포함해 몇 가지 definition에 대해 소개하겠습니다.</p>

<p>$\mathcal{G} = (\mathcal{V}, \mathcal{E}, \mathcal{A}, \mathcal{X})$는 $n$개의 node를 가진 attributed graph, 즉 각 node가 attribute 정보를 가진 graph를 의미합니다. 여기서 $\mathcal{V}, \mathcal{E}$는 각각 node set ${v_ i}_ {i = 1}^ {n}$, edge set ${e_ {ij}}$를 나타내고, $e_ {ij} = (v_ i, v_ j)$는 두 node $v_ i$와 $v_ j$ 사이를 잇는 edge가 있음을 뜻합니다. $\mathcal{A} \in {0,1}^ {n \times n}$은 $\mathcal{G}$의 topological structure를 나타내는 adjacency matrix인데, $\mathcal{A}$의 각 element $a_ {ij}$에 대해 $e_ {ij} \in \mathcal{E}$라면 $a_ {ij} = 1$, 그렇지 않다면 $a_ {ij} = 0$입니다. Attribute matrix $\mathcal{X} \in \mathbb{R}^ {n \times k}$에는 각 node $n_ i$의 $k$-dimensional attribute $x_ i$가 들어갑니다.</p>

<p>Attributed graph $\mathcal{G}$가 주어졌을 때, GAD task는 binary classification task로 치환될 수 있습니다. 이는 각 node $v_ i$에 대해 $v_ i$가 anomaly라면 1을, 그렇지 않다면(즉 normal node라면) 0을 label로 부여하는 것을 의미합니다(i.e. $\mathcal{V} \to Y \in {0,1}^ n$). 이 논문에서 DAGAD는 <strong>label이 무엇인지 아는 소수의 node를 통해 나머지 node의 label을 예측하는 task</strong>를 수행합니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Proposed Framework</strong></p>
</blockquote>

<p>이제 본격적으로 DAGAD에 대해서 살펴보겠습니다. 먼저 전체 framework를 간략히 소개하겠습니다.</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231733631-57de257b-c8fc-4058-baff-b244ec8e090d.png" alt="image" /></p>

<p>위 figure에서 볼 수 있듯이, DAGAD는 <strong>3개의 module</strong>의 collaboration으로 이루어져 있습니다. 먼저 <strong>Information Fusion Module</strong>은 2개의 GNN encoder를 통해 graph topology와 node attribute, 2개의 관점에 대해서 각각 node representation을 구합니다. 그 다음 <strong>Data Augmentation Module</strong>이 앞서 학습한 representation을 기반으로 추가 sample을 생성해 training set에 추가합니다. 이후 <strong>Imbalance-tailored Learning Module</strong>은 anomaly와 normal node의 차이가 드러나도록 학습하고, 이때 class-wise loss를 통해 class imbalance 문제를 완화할 수 있습니다. 이 3개의 module로 구한 output을 기반으로 각 node의 label(normal 또는 anomalous)을 최종적으로 예측하게 됩니다.</p>

<p>아래에서 각 module에 대해 더 자세히 설명하겠습니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>A. Information Fusion Module</strong></p>
</blockquote>

<p>Node attribute 정보의 방대함과 graph topology 정보의 복잡성으로 인해, 기존 graph data를 그대로 가지고 GAD를 수행하는 것은 쉽지 않습니다. 때문에 DAGAD는 encoder를 통해 구한 low-dimensional representation으로 anomaly와 normal node를 구분합니다. 이때 encoder는 $\phi : {\mathcal{A,X}} \to H \in \mathbb{R}^ {n \times d}$의 형태를 띄는데, 여기서 $H$는 각 node $v_ i$에 대해 $d \ll k$를 만족하는 $h_ i \in \mathcal{R}_ d$로 이루어져 있습니다.</p>

<p>DAGAD는 graph 정보 representation에서 좋은 성능을 보이는 GNN 모델을 encoder로써 차용해 neighborhood 정보를 aggregate하는데, 그 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231952382-f10f09a1-2938-429c-b83b-f08035a65046.png" alt="image" /></p>

<p>위 식에서 $h_ i ^ l$은 GNN의 $l$번째 layer에서 node $v_ i$의 representation을 의미하고, set $\mathcal{N}(i)$는 $v_ i$의 neighborhood에 있는 나머지 node들로 이루어져 있습니다. 또한 $f_ {AGG}(\cdot)$는 node representation을 aggregate(sum, mean 등)하는 역할을 하고, 이때 initial representation은 node attribute입니다(i.e. $h_i ^ 0 = x_ i$).</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>B. Data Augmentation Module</strong></p>
</blockquote>

<p>Information fusion module에서 학습한 representation만을 바탕으로 GAD를 수행한다면 suboptimal한 performance에 맞닥뜨리게 됩니다. 이는 소수의 기존 anomalous sample에서 얻은 한정된 정보만을 사용하는 anomaly detector는 anomaly와 normal node를 확실하게 구분하기 어렵기 때문입니다. 여기서 DAGAD의 data augmentation module가 이 anomalous sample scarcity 문제를 완화할 수 있습니다. Graph 구조나 node attribute에 변형을 가하는 다른 augmentation technique과는 달리, DAGAD는 <strong>node representation을 바탕으로 새로운 sample을 생성</strong>하여 training set에 anomaly에 대한 정보를 풍부하게 하는 것을 목표로 하고 있습니다.</p>

<p><br /> <br /></p>

<p><strong>1. Augmentation on Representation</strong></p>

<p>DAGAD의 target은 anomaly와 normal class 간의 boundary를 학습하는 것입니다. 이를 위해 두 classifier $C_ a, C_ b$를 쓰는데, 여기서 <strong>$C_ a$는 anomalous class에 overfit하여 anomaly-related feature를 얻는 것을 목적으로 하고, 이를 통해 최종 classifier $C_ b$의 성능을 강화</strong>합니다.</p>

<p>우선 training set에 있는 기존 sample을 augment하기 위해 Eq. (1)으로 얻은 representation에 random permutation을 가하는데, 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231967761-4868844c-47f2-4dcd-b97d-1b668c3ecf26.png" alt="image" /></p>

<p>위 식에서 $\tilde{H}$는 $PERMUTE : h_ i \to \tilde{h_ j} \in \tilde{H}$를 통해 얻은 permuted representation으로 이루어져 있습니다. 다음으로 두 classifier $C_ a, C_ b$가 함께 작동하도록 하기 위해 두 representation을 concatenate하는데(즉 <strong>information fusion module에서 2개의 GNN encoder를 학습</strong>), 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231970254-b633aa9b-0968-4c32-922b-27305c40b05b.png" alt="image" /></p>

<p>위 식에서 $h_ i ^ {C_ a}, h_ i ^ {C_ b}$는 각각 $C_ a, C_ b$에 쓰일, 앞선 module에서 학습된 representation을 의미합니다. 같은 논리로 augmented sample은 $C_ a$의 기존 representation과 $C_ b$의 permuted representation을 concatenate하여 구합니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231971100-f5922392-e9be-46e2-893b-4925d8024913.png" alt="image" /></p>

<p>이때 augmented representation도 $C_ b$의 학습에 쓰이기 때문에, augmented sample의 label도 $\tilde{y} = PERMUTE(y)$에 따라 부여됩니다. 즉 $\tilde{h_ i}^ {C_ b}$의 label이 $\tilde{\mathrm{h}_ i} ^ {C_ b}$의 label이 됩니다.</p>

<p><br /> <br /></p>

<p><strong>2. Complementary Learning</strong></p>

<p>이제 augmented representation이 포함된 training set에 대해 <strong>두 classifier $C_ a, C_ b$를 complementary하게 학습</strong>합니다. 여기서 complementary란 두 classifier가 정보를 주고받으며 상호보완적으로 학습됨을 뜻합니다. 각 classifier에서 fully-connected layer가 2개인 MLP $f^ {MLP}(Z; \theta)$를 통해 각 node의 최종 representation을 구하는데, 여기서 $Z$는 앞서 구한 concatenated representation이고 $\theta$는 학습 가능한 parameter set입니다. Input $\mathrm{h} \in \mathbb{R}^ {2d}$에 대해 MLP의 각 layer는 다음과 같은 형태입니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231977391-d25280f2-1600-4646-b1fa-bdbfed39ba59.png" alt="image" /></p>

<p>위 식에서 $W \in \mathbb{R}^ {D \times 2d}, b \in \mathbb{R}^ D$는 각각 학습 가능한 weights와 bias를 의미하고, 이를 통해 기존 sample과 augmented sample 각각에 대해 최종 representation $\mathrm{h}^ * \in \mathbb{R}^ 2, \tilde{\mathrm{h}}^ * \in \mathbb{R}^ 2$를 구할 수 있습니다. 이후 다음과 같이 softmax function으로 각 node가 anomaly이거나 아닐 확률을 구하고 이를 바탕으로 각 node에 label을 부여합니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231979818-58b92ce0-10a0-47c3-adb0-001bbce9a58e.png" alt="image" />
<img src="https://user-images.githubusercontent.com/86581545/231979969-dc4df956-e1c3-4a16-ae23-4e56de0e50f9.png" alt="image" /></p>

<p>앞서 언급했듯이 $C_ a, C_ b$는 complementary하게 학습됩니다. 기존 training sample에 대해서 $C_ a$에는 cross entropy (CE) loss를, $C_ b$에는 generalized cross entropy (GCE) loss를 적용합니다. 여기서 $C_ a$는 anomaly class와 가장 연관이 있는 feature를 학습하도록 overfit 시켜, $C_ b$가 anomaly와 normal class를 구분하는 feature를 잘 학습하여 더 좋은 detection 결과가 나오도록 합니다. 요약하자면 <strong>$C_ a$는 anomaly를 더 잘 드러내는 feature에 훨씬 집중하도록 학습되어 이 정보를 $C_ b$에 전달</strong>하고, <strong>$C_ b$는 이 정보를 활용해 anomalous class와 normal class를 더 잘 구분하도록 학습</strong>됩니다. 즉, 실제 detection은 $C_ b$에 의해 이루어집니다. 이를 위해 $C_ a$는 anomaly에 더 bias될 수 있도록 weight가 조정된 CE loss로 학습되고(weight에 대한 설명은 다음 module에서 이루어집니다), $C_ b$는 anomaly라는 noise에 좀 더 robust한 GCE loss로 학습됩니다. 이 합쳐진 objective의 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231982046-1ec8bee1-3c8d-4af7-ac3f-12d1862bef16.png" alt="image" /></p>

<p>위 식에서 $\psi_ {CE}, \psi_ {GCE}$는 각각 CE loss function과 GCE loss function을 의미하고, $\omega$는 $C_ a, C_ b$ 간에 complementary 정보 교환이 일어나도록 하는데 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231982581-e2526f1a-f71e-4039-8f00-d190e853f14b.png" alt="image" /></p>

<p>$C_ b$는 augmented sample 또한 GCE loss에 넣는데, 이 objective의 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231983801-34c25bf2-d121-40a7-afa6-9df5e7802590.png" alt="image" /></p>

<p>앞서 나온 부분을 모두 통합한 DAGAD의 overall loss function은 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231984057-40e88ff0-9111-42fa-a417-038f5408fc7d.png" alt="image" /></p>

<p>이때 $h^ {C_ a}, h^ {C_ b}$가 각각 $C_ a, C_ b$에 의해서 학습이 주로 되도록 하기 위해, $C_ b$에서의 loss는 $h_ i ^ {C_ a}$를 학습하는 encoder로 backpropagate되지 않고, $C_ a$에서의 loss는 $h_ i ^ {C_ b}$를 학습하는 encoder로 backpropagate되지 않습니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Imbalance-tailored Learning Module</strong></p>
</blockquote>

<p>Imbalanced training data 문제로 인해, GAD에서 normal class에 대한 bias와 anomaly에 대한 under-training이 주로 발생합니다. 학습 과정에 두 class로부터의 contribution의 균형을 맞추기 위해 DAGAD는 Eq. (11)을 기반으로 한 <strong>class-wise loss function</strong>을 제안합니다. 모든 training sample을 동일하게 취급하지 않고 class별로 다른 weight를 부여하는데, 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231987501-df38d230-5147-4b37-b65e-e98a108ed5e3.png" alt="image" /></p>

<p>위 식에서 $\vert \mathcal{V}_ {train} ^ {anm} \vert, \vert \mathcal{V}_ {train} ^ {norm} \vert$은 각각 training set 내에서 anomaly와 normal sample의 개수를 의미합니다. 이와 비슷하게 새로 class-wise GCE loss를 정의할 수 있는데, 형태는 다음과 같습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231988125-596033ef-b66c-4a1f-8686-4e9eab55b8d7.png" alt="image" /></p>

<p>이를 통해 다음과 같이 Eq. (11) 대신에 새로운 overall loss를 정의할 수 있습니다:</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231988438-2e49a705-d543-44b3-8c35-4d37f2975f6a.png" alt="image" /></p>

<p>이때 $\hat{\mathcal{L}}_ {org} ^ {C_ a}, \hat{\mathcal{L}}_ {org} ^ {C_ b}, \hat{\mathcal{L}}_ {aug} ^ {C_ b}$는 각각 $\mathcal{L}_ {org} ^ {C_ a}, \mathcal{L}_ {org} ^ {C_ b}, \mathcal{L}_ {aug} ^ {C_ b}$에 instance-wise CE loss 와 GCE loss 대신에 Eqs. (13)과 (14)를 적용한 것입니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Algorithm</strong></p>
</blockquote>

<p><img src="https://user-images.githubusercontent.com/86581545/231989358-e6599b9d-98d9-4744-866a-47d40cb3d977.png" alt="image" /></p>

<p>위 pseudocode는 앞서 설명한 3개의 module이 DAGAD에서 어떻게 돌아가는지 보여줍니다.</p>

<p><br /> <br /></p>

<h2 id="4-experiment">4. Experiment</h2>

<p>이 논문은 여러 종류의 실험과 ablation study를 통해 다음 3개의 research question에 답하고자 합니다:</p>
<ul>
  <li>Q1: DAGAD는 SOTA baseline method와 비교해 우위를 가지는가?</li>
  <li>Q2: Data augmentation module이 anomaly detection에 도움을 주는가?</li>
  <li>Q3: Imbalance-tailored learning module이 anomaly detection에 도움을 주는가?</li>
  <li>Q4: DAGAD가 sensitive한 hyper-parameter가 있는가?</li>
</ul>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Experimental Setup</strong></p>
</blockquote>

<p><strong>Datasets</strong></p>

<p>다음과 같이 3개의 real-world dataset에 anomaly를 inject해 실험에 사용합니다. 여기서 injection은 DOMINANT라는 논문에서 제안한 scheme에 따라 이루어지는데, 더 자세한 내용은 맨 아래 reference를 통해 확인할 수 있습니다. 이때 training set에는 전체 node의 20%, test set에는 80%를 넣고, 각 set에서 anomaly의 비율은 전체 dataset에서의 비율과 같도록 합니다.</p>

<p><img src="https://user-images.githubusercontent.com/86581545/231993234-a81e23d9-f4ce-49ab-80d6-faf1006fab8e.png" alt="image" /></p>

<p><strong>Baselines</strong></p>

<p>다음과 같이 10개의 deep graph learning 기반 anomaly detector과 비교합니다.</p>
<ul>
  <li>Semi-supervised: GCN-Detector, GAT-Detector, GraphSAGE-Detector, GeniePath-Detector</li>
  <li>Unsupervised: FdGars, DONE, AdONE, DOMINANT, AnomalyDAE, OCGNN</li>
</ul>

<p>DAGAD의 경우 GNN encoder로 사용한 모델에 따라 DAGAD-GCN과 DAGAD-GAT로 나누었습니다.</p>

<p><strong>Evaluation Metrics</strong></p>

<p>다음과 같이 5개의 metric으로 detection performance를 측정합니다.</p>
<ul>
  <li>Macro-Precision, Macro-Recall, Macro-F1-score, ROC curve, AUC score</li>
</ul>

<p>이때 semi-supervised detector와는 Macro-Precision, Macro-Recall, F1-score를 비교하고, unsupervised detector와는 ROC curve와 AUC score를 비교합니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Detection Performance (Q1)</strong></p>
</blockquote>

<p><strong>1. Comparison with Semi-supervised Detectors</strong></p>

<p><img src="https://user-images.githubusercontent.com/86581545/231996880-232eff9c-5f73-4643-9b7c-944bb093c1ff.png" alt="image" /></p>

<p>F1-score의 경우 다른 detector보다 DAGAD의 성능이 높은 것을 확인할 수 있습니다. 이는 <strong>DAGAD에서 class imbalance 문제를 완화해주는 class-wise loss function이 효과적임을 의미</strong>합니다. Recall의 경우에도 DAGAD의 성능이 월등한데, normal node로 misclassify되는 anomaly의 비율이 훨씬 적다는 것을 알 수 있습니다. Precision의 경우 다른 detector의 성능이 더 좋지만, 이를 위해 recall이 희생됐다고 해석할 수 있습니다.</p>

<p><strong>2. Comparison with Unsupervised Detectors</strong></p>

<p><img src="https://user-images.githubusercontent.com/86581545/231999977-78d30b17-ffc0-4322-b004-af0bb3f4fa1e.png" alt="image" />
<img src="https://user-images.githubusercontent.com/86581545/231999524-08c58e3c-4c9d-467b-ac2d-8c9e581a9046.png" alt="image" /></p>

<p>위의 차트와 표에서 각각 ROC-curve와 AUC-score를 확인할 수 있습니다. BlogCatalog와 Flickr dataset에서는 월등히 높은 성능, ACM dataset에서는 상위권의 성능을 보입니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Ablation Study (Q2, Q3)</strong></p>
</blockquote>

<p>Data augmentation module과 Imbalance-tailored learning module의 기여도를 확인하기 위해 앞서 소개한 3개의 dataset에 4개의 DAGAD variant에 대한 실험을 하였습니다.</p>
<ul>
  <li>$\mathrm{DAGAD-GCN_ {-IMB} ^ {-AUG}}, \mathrm{DAGAD-GAT_ {-IMB} ^ {-AUG}}$는 두 module 모두 제외합니다. 즉 augmented sample 없이, 그리고 instance-wise CE loss로 학습합니다.</li>
  <li>$\mathrm{DAGAD-GCN_ {-IMB}}, \mathrm{DAGAD-GAT_ {-IMB}}$는 imbalance-tailored learning module을 제외합니다.</li>
</ul>

<p><img src="https://user-images.githubusercontent.com/86581545/232004616-24800b04-0199-4d61-baac-5b0b955c327e.png" alt="image" /></p>

<p>위 표에서 볼 수 있듯이, module이 하나 또는 2개 모두 제외된 variant에 비해 원본이 월등히 성능이 높습니다. 따라서 <strong>data augmentation module과 imbalance-tailored learning module 모두 anomaly detection performance에 효과적으로 기여</strong>한다고 할 수 있습니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>Sensitivity to Hyper-Parameters (Q4)</strong></p>
</blockquote>

<p>Eq. (15)에서 $\alpha, \beta$의 값이 $C_ a, C_ b$ 각각의 training loss의 균형을 맞추는 데 중요한 역할을 한다는 것을 확인할 수 있습니다. 따라서 DAGAD가 두 parameter에 얼마나 sensitive한지 알아보기 위해, BlogCatalog dataset에서 값을 바꿔가며 결과를 뽑았습니다. 이때 $\alpha \in {1.0, 1.2, 1.4, 1.5, 1.6, 1.8, 2.0}, \beta \in {0.1, 0.3, 0.5, 0.7, 0.9, 1.1}$입니다.</p>

<p><img src="https://user-images.githubusercontent.com/86581545/232007109-a2760ee4-efc7-46d3-b1c6-091eb5644398.png" alt="image" /></p>

<p>가장 결과가 좋은 $\alpha, \beta$ 값은 각각 1.6, 0.9 근처임을 확인할 수 있습니다.</p>

<p><br /> <br /></p>

<h2 id="5-conclusion"><strong>5. Conclusion</strong></h2>
<blockquote>
  <p><strong>Summary</strong></p>
</blockquote>

<p>이 논문에서는 Graph Anomaly Detection에서 흔히 문제가 되는 <strong>anomalous sample scarcity</strong>와 <strong>class imbalance</strong> 문제를 다루었습니다. 소개된 DAGAD 모델은 각각 <strong>data augmentation을 통한 sample generation</strong>과 <strong>class-wise loss function</strong>을 통해 두 문제를 해결하려 합니다. 널리 쓰이는 3개의 real-world dataset에 대해 여러 metric에서 10개의 baseline과의 비교를 통해 성능이 높음을 확인할 수 있습니다. 앞으로 class-imbalanced data에서의 발전이 기대가 됩니다.</p>

<p><br /> <br /></p>

<blockquote>
  <p><strong>생각 및 발전 방향</strong></p>
</blockquote>

<p>Anomaly에 해당하는 sample의 개수가 너무 부족하다는, 단순하지만 치명적인 문제에 접근해 해결책을 찾으려 시도한 점이 인상 깊었습니다. 주로 몇 개 없는 sample에서 어떻게든 정보를 더 얻으려 하는 다른 method에 비해, 그저 있는 정보를 잘 짜깁기하여 생성한 sample을 추가한 DAGAD가 성능이 훨씬 좋은 것이 흥미로웠습니다. 글도 읽기 쉽게 쓰여 있어 이해하기 어렵지 않은 논문이었습니다.</p>

<p>다만 몇 가지 의문점이 있습니다. 가장 먼저 논문에서 제기한 두 가지 문제, 즉 <strong>anomaly의 ‘절대적인’ 개수가 부족</strong>하다는 점과 <strong>normal node와 비교했을 때의 ‘상대적인’ 개수가 부족</strong>하다는 점이 과연 별개의 문제로 취급될 만한지 궁금합니다. 어떻게 보면 결국 같은 말이니까요.</p>

<p>위 의문점의 연장선으로, data augmentation module에서 <strong>왜 normal sample도 추가로 생성하는지</strong> 의아합니다. 논문에서의 설명대로라면 anomaly sample이 2배, normal sample도 2배로 늘어나는 것인데 이러면 결국 비율은 그대로이기 때문에 <strong>class imbalance는 해결되지 않는 것</strong>으로 보입니다. 물론 뒤의 imbalance-tailored learning module에서 class imbalance는 따로 다루지만, 이왕 생성하는 김에 <strong>anomaly만 더 생성해 애초에 비율을 늘리고</strong> 넘어가면 성능이 더 향상되지 않았을까 싶습니다.</p>

<p>마지막으로 hyper-parameter sensitivity analysis에서 왜 $\alpha, \beta$의 범위(1 - 2 vs 0 - 1)이 다른지 궁금합니다. 식에 넣으면 무조건 $C_ a$의 loss가 훨씬 중요하게 작용하는데, fair한 실험인지 의문입니다.</p>

<p>위 의문점을 해소하면서 실험하는 것도 괜찮은 발전 방향인 것 같습니다.</p>

<p>Thank you for reading!</p>

<p><br /> <br /></p>

<h2 id="author-information"><strong>Author Information</strong></h2>
<ul>
  <li>Junghoon Kim
    <ul>
      <li>Affiliation: <a href="http://dsail.kaist.ac.kr">DSAIL@KAIST</a></li>
      <li>Research Topic: Graph Learning, Anomaly Detection</li>
      <li>Contact: jhkim611@kaist.ac.kr
        <h2 id="reference--additional-materials"><strong>Reference &amp; Additional materials</strong></h2>
      </li>
    </ul>
  </li>
  <li>Github Implementation
    <ul>
      <li><a href="https://github.com/FanzhenLiu/DAGAD">Official codes for the paper</a></li>
    </ul>
  </li>
  <li>Reference
    <ul>
      <li><a href="https://arxiv.org/abs/2210.09766">[ICDM-22] DAGAD: Data Augmentation for Graph Anomaly Detection</a></li>
      <li><a href="https://epubs.siam.org/doi/10.1137/1.9781611975673.67">DOMINANT (anomaly injection scheme 제안)</a></li>
    </ul>
  </li>
</ul>


    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2023 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Oct 23, 2023 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>



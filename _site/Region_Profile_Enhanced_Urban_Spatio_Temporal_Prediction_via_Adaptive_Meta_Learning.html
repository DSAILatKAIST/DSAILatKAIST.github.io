<!DOCTYPE html>
<html>
<head>
    <meta name="google-site-verification" content="1tAPTdgw0-t8G2Bya463OpBtYUbj9Um93gfnsowYKLw" />
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[CIKM 2023] Region Profile Enhanced Urban Spatio-Temporal Prediction via Adaptive Meta-Learning | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://localhost:4000/feed.xml">


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>




    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS535_2023.html">DS535 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2024.html">DS503 (2024)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [CIKM 2023] Region Profile Enhanced Urban Spatio-Temporal Prediction via Adaptive Meta-Learning page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[CIKM 2023] Region Profile Enhanced Urban Spatio-Temporal Prediction via Adaptive Meta-Learning">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
          
          
          <li><a title="DS535 (2023F)" href="reviews_DS535_2023.html">DS535 (2023F)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[CIKM 2023] Region Profile Enhanced Urban Spatio-Temporal Prediction via Adaptive Meta-Learning</h1>
        <p class="post-meta"><time datetime="2024-04-17T00:00:00+09:00" itemprop="datePublished">Apr 17, 2024</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h1 id="region-profile-enhanced-urban-spatio-temporal-prediction-via-adaptive-meta-learning"><strong>Region Profile Enhanced Urban Spatio-Temporal Prediction via Adaptive Meta-Learning</strong></h1>
<blockquote>
  <p>Info
	&gt;   -  <strong>Authors</strong>: Jie Chen, Shanghai University
	&gt; - <strong>Key words</strong>: Urban spatio-temporal prediction; Meta-learning; Deep learning
	&gt; - <strong><a href="https://dl.acm.org/doi/pdf/10.1145/3583780.3615027">Paper Links</a></strong></p>
</blockquote>

<h2 id="1-problem-definition"><strong>1. Problem Definition</strong></h2>

<p><strong>Background</strong>
도시 센싱 기술과 모바일 컴퓨팅의 빠른 발전은 지능형 도시 구축을 크게 촉진하였다. 그 중 도시 공간-시간 (Spatio-temporal, ST) 예측은 가장 주목받는 스마트 도시 서비스 중 하나로, 궤적 예측, 경로 시간 추정, 출발지-목적지 수요 예측과 같은 다양한 도메인의 응용을 가능하게 한다. 
예를 들어, 업무지구는 주로 평일 오전과 저녁에 사람들이 몰리는 반면, 주거 지역은 주말에 더 활발할 수 있다는 점을 활용한다면, 해당 지역의 사람들의 궤적을 예측하거나, 사람들의 경로에 대한 시간을 추정하는 등의 서비스로 이어질 수 있다. 따라서, 정확한 ST 예측 시스템은 스마트 도시 서비스의 효율성을 향상시키고, 비상 상황에 대한 조기 경고를 제공하며, 정책 결정에 필요한 통찰을 제공하는 중요한 역할을 제공할 수 있다.</p>

<p><strong>Problem</strong>
이 논문에서는 각 지역에서 수집할 수 있는 데이터가 한정적인 상황에서 어떻게 효과적인 ST 예측을 수행할 수 있는지에 대해 초점을 맞추고 있다.</p>

<h2 id="2-motivation"><strong>2. Motivation</strong></h2>

<p><strong>Challeng of ST prediction</strong>
기존의 하이브리드 딥러닝 모델들은 ST 예측을 높은 성능으로 수행하고 있다. 하지만, 이러한 모델들은 대규모 훈련 데이터에 의존하고 있기 때문에 각 지역의 데이터 수집이 어렵고, 수집된 데이터 또한 불안정할 수 있는 실제 도시 환경 상황에는 알맞지 않다는 한계점이 존재하였다. 
 그래서 최근에는 데이터가 부족한 시나리오에서도 예측이 가능한 고급 메타러닝 방법을 ST예측 태스크에 사용하는 연구가 증가하고 있는 추세이다. 그런데, 이러한 기존 연구들에서는 학습 과정에서 지역 간의 내제되어 있는 차이로 인해 발생되는 부정적인 transfer를 피하지 못하고 있다는 한계점이 발생하였다. 예를 들어, Figure1과 같이 두 다른 지역에 일정 부분이 거의 일치하는 ST 역학을 보일 때(예: 아침, 저녁 피크), 지역간에 차이가 있음에도 불구하고  유사하게 관찰된 ST 역학에 동일한 클러스터링 메타 전략이 적용되는 상황이 발생한다는 것이다.<br />
<img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure1.png" alt="image1" /></p>

<p><strong>Proposed Idea</strong>
이 논문에서 제안하는 MetaRSTP 모델은 기존연구의 한계점을 극복할 수 있도록 지역간 이동성과, 지역내 특징을 활용하여 지역 프로필을 추출하는 새로운 임베딩 방식을 사용하였다. 또한,  regional bias generator를 활용해 프로파일에 관한 비공유 파라미터를 도출하여 지역간의 차이를 완화하였다. 저자는 고정된 generalizable parameter와 region-adaptive bias로 네트워크를 초기화 하는 새로운 메타러닝 전략을 설정함으로써, 데이터가 적은 시나리오에서도 성능이 강화할 수 있도록 모델을 설계하였다.</p>

<p>저자들이 제시한 이 새로운 메타러닝 전략은 각 지역의 특수성을 고려하여 개인화된 지역의ST 예측 성능을 향상시킬 뿐만 아니라, 데이터가 부족한 환경에서도 높은 예측 정확도를 제공할 수 있도록 도왔다.</p>

<h2 id="3-preliminary"><strong>3. Preliminary</strong></h2>

<p><strong>Definition</strong>
저자들은 이전 연구에 따라 도시들을 $N_R$개의 독립적인 지역들로 나누고,  $R = {r_1, r_2, \ldots, r_{N_R}}$로 표현했다.  그리고 아래와 같은 5개의 ST 예측에 필요한 개념 5개를 정의하였다.</p>

<p><code class="language-plaintext highlighter-rouge">Definition1. Inter-Region Mobility View</code>는 지역 간의 상호작용을 표현한다. 이 뷰는 다양한 지역 간의 원산지와 목적지(OD) 데이터를 통해 이동 패턴을 수치적으로 표현하고, 각 지역 간의 연결 강도를 파악한다.</p>

<p>따라서, 지역 $r_i$에 대한 OD(원산지-목적지) 맥락은 아래의 두가지 분포로 표현된다.</p>
<ol>
  <li>출발 확률 분포  $p_o(r_k \mid r_i)$:
지역 $r_i$에서 출발하여 지역 $r_k$로 도착하는 상대적 이동성 확률을 나타낸다.
  $p_o(r_k \mid r_i) = \frac{w(r_k, r_i)}{\sum_{r_j} w(r_j, r_i)}$</li>
  <li>도착 확률 분포 $p_d(r_k \mid r_i)$:
지역 $r_i$로 도착하는 이동성 확률 중에서 지역 $r_k$에서 출발한 비율을 나타낸다.
$p_d(r_k \mid r_i) = \frac{w(r_ {i}, r_ {k})}{\sum_ {r_ {j}} w(r_ {i}, r_ {j})}$</li>
</ol>

<p>위에서 사용된, 이동 가중치 $w(r_i, r_j)$는 지역 $r_i$에서 지역 $r_j$로의 여행 발생 횟수를 나타내는 수치이다. 이 수치는 다음과 같이 계산된다.</p>

<p>$w(r_ {i}, r_ {j}) = \vert (r_ {o}, r_ {d}) \in M \mid r_ {o} = r_ {i}, r_ {d} = r_ {j} \vert$</p>

<p>여기서 $\vert \cdot \vert$는 집합 내 원소의 개수를 세는 연산으로, 특정 조건을 만족하는 여행 쌍의 발생 빈도를 계산한다. 즉, 지역 $r_ {i}$에서 출발하여 지역 $r_ {j}$로 도착하는 모든 여행 쌍 $(r_ {o}, r_ {d})$의 개수를 세어 이동성 가중치를 결정한다.</p>

<p><code class="language-plaintext highlighter-rouge">Definition2. Intra-Region Geospatial View</code>는 각 지역의 지리적 특성을 관심 지점(POI)의 분포 p와 도로 네트워크 density d로 나타낸다. ( $f={p,d}$) 이것은 지역의 기능과 속성을 나타낼 수 있다.   p에 있는 차원은 대응하는 POI의 카테고리의 비율을 나타내고, d에 있는 차원은 면적을 도로 길이로 나눈 값으로 계산된다.</p>

<p><code class="language-plaintext highlighter-rouge">Definition3. Region profile</code>는 타겟 지역의 이동성 패턴과 지리적 특성에 기반한 지역 프로필을 학습하여, 각 지역을 포괄적으로 설명할 수 있는 임베딩을 생성 (E=${e_{r_i}}$)한다.</p>

<p><code class="language-plaintext highlighter-rouge">Definition4. Urban Dynamic State</code> 도시 ST데이터는 도시 ST 데이터에는 택시 수요, POI 체크인 등이 포함되며, 공간적으로 변화하고 시간에 따라 진화한다. 그래서, 저자는 시간 범위를 동일한 길이의 시간 슬롯으로 나누고, 각 지역에서의 동적 상태(e.g., 택시 픽업 횟수)를 해당 시간 슬롯에서 나타낸다.</p>

<p><code class="language-plaintext highlighter-rouge">Definition5. Urban ST Sequence</code>  지리학의 첫 번째 법칙에 따라, 인접 지역들은 자연스럽게 명시적인 공간 의존성을 나타낸다. 특정 시간 슬롯 $t$에서, 지역 $r_i \in R$는 벡터 $x_{r_ {i}}^{(t)} = [x_{r_ {k}}^{(t)}] \in \mathbb{R}^{N_ {S}}$와 관련되어 있는데, 이 벡터는 지역 $r_i$와 그 공간적 이웃 지역들(자기 자신을 포함하여 다른 $N_S - 1$ 지역들)의 도시 상태를 집약하여 나타낸다. 이러한 공간적 특성을 연속적인 시간 슬롯 $T$에 걸쳐 수집함으로써, 저자는 도시 ST 시퀀스를 $S_{r_i} = [x_{r_i}^{(t)}]_{t=t_c-T}^{t=t_c} \in \mathbb{R}^{T \times N_S}$로 표현하는데, 여기서 $t_c$는 마지막 시간 슬롯이다.</p>

<p><strong>Problem Formalization</strong>
저자들은 이렇게 5가지의 개념을 정의한 뒤,  지역 $r_i$에 대하여 $T$ 개의 과거의 동적 특성과 해당 지역 프로필 $e_{r_i} \in E$이 주어졌을 때, 다음 도시 상태를 예측하기 위한 함수 $f_{\phi_{r_i}}(\cdot)$를 학습하는 모델을 구성하였다:</p>

<p>$f_{\phi_{r_i}}([S_{r_i}; e_{r_i}]) \rightarrow y_{r_i}^{(t+1)}$</p>

<p>여기서 $y_{r_i}^{(t+1)}$는 실제 값이며, $f_{\phi_{r_i}}(\cdot)$는 $\phi_{r_i}$로 파라미터화된 특정 예측 신경망이다.</p>

<p><strong>Meta-Learning setting</strong>
메타 러닝은 다양한 학습 태스크들 간에 공통적인 지식을 추출하고, 이를 새로운 태스크에 빠르게 적용하여 효과적인 학습을 가능하게 하는 방법이다.  이 연구에서는 지역 수준의 ST 예측을 하나의 학습 태스크로 간주하는 메타 러닝을 사용했으며, 각 태스크를 관측된 데이터를 토대로 지원 세트와 쿼리 세트로 나눴다. 전자는 지역 업데이트 동안 초기 네트워크를 미세 조정하는데 사용되며, 후자는 전역 업데이트 동안 일반화된 초기 네트워크를 학습하는데 사용된다. 적은 수의 샘플을 가진 시나리오와 일반 시나리오를 모방하기 위해 샘플 수를 조정함으로써, 강력한 적응력을 가진 예측 모델을 얻기 위한 훈련 태스크의 배치가 샘플링 된다.</p>

<h2 id="4-method"><strong>4. Method</strong></h2>
<p>저자들은  지역 프로필을 활용한 adaptive meta learning 프레임워크, MetaRSTP를 만들 때 1. 포괄적인 지역 특성을 뽑아낼 수 있도록 하는 지역 프로필을 뽑는 것과 2. 추출된 지역 프로필을 기반으로 부정적인 잡음을 배제하는 메타러닝을 개발하는 것을 목표로 모델을 구성하였다.</p>

<p><img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure2.png" alt="image2" />
위 그림은 저자가 제시한 MetaRSTP의 모델 아키텍쳐이다.</p>

<h3 id="1-multi-view-region-profile-learner"><strong>1. multi-view region profile learner</strong></h3>
<p>포괄적인 지역 특성을 뽑아낼 수 있도록 하는 지역 프로필을 뽑기 위해서,  저자들은 위 그림의 (a) 구조를 제안하였다. 자세한 설명은 아래와 같다.</p>

<p>[1] <strong>두개의 single view를 통한 지역 임베딩</strong>
저자는 지역간의 mobility view와 지역 내의 geospatial view, 즉 두 개의 single-view encoders를 별도로 구현하여 차별화된 특성 추출을 수행하였다.</p>

<p>mobility view에서는, 유사한 original distribution이나 destination distribution을 가지는 지역들을 서로 근접한 것으로 간주하여 유사한 도시에 대한 기능에 대한 힌트를 제공하였다. 이때, 코사인 유사도가 상위 $N_M$인 지역과 연결하였는데, 지역간 이동성은 그래프를 통해 구축하였다. 지역의 mobility correlation을 임베딩에 통합하기 위해, Graph Attention Network, GAT를 사용하였으며, 이때 지역 간의 원산지-목적지(OD) 연결성을 기반으로 attention score을 계산하였다. 이후, 이 score를 가지고 이웃들로부터 정보를 전파하여 각 region의 representation을 업데이트하였다.</p>

<ul>
  <li>각 지역 $r_i$와 연결된 지역 $r_j$에 대해, 다음과 같이  Attention Score를 계산하였다:</li>
</ul>

<p>$\alpha_ {ij}^{m} = \frac{\exp(\text{LeakyReLU}(a_ {m} [W_ {m} v_ {i} | W_ {m} v_ {j}]))}{\sum_{k \in N_ {em}[r_ {i}]} \exp(\text{LeakyReLU}(a_ {m} [W_ {m} v_ {i} | W_ {m} v_ {k}]))}$</p>

<p>그리고, attention score를 가지고 region embedding을 업데이트 하였다.
$e_ {r_i}^{m} = \sum_ {j \in N_ {em}[r_ {i}]} \alpha_ { ij}^{m} \Phi_ {m} v_ {j}$</p>

<p>이때, $\alpha^{m}_ {ij}, \Phi_ {m}, \alpha_ {m}$이 학습 파라미터이다.</p>

<p>한편, geospatial view에서는 coarse POI와 road density feature를 $e_ {ij}^{g}$로 변환하는데, MLP를 사용하였다.</p>

<p>[2] <strong>두 view를 통해 나온 지역 임베딩으로 부터 semantic alignment space 설계.</strong>
저자는 두 view간에 semantic constraint을 다루고, co-semantic을 밝히는 semantic alignment space 을 구축하였다. 
저자는 한 지역의 두 view의 specific 특징이 동일한 기저 지역 패턴을 반영하기 때문에 서로 일치할 수 있다는 직관적인 생각을 바탕으로 space를 설계하였다. 예를 들어, 중심 지역에서의 이동성 연관성은 넓은 범위의 지역들과의 연관성과 높은 도로 밀도, 다양한 유형의 POI 분포와 일치한는 것이다.</p>

<p>그래서, 저자는 대조 학습에 의해 동기를 받아 긍정적인 쌍들과 부정적인 쌍들을 노이즈 대조 추정(Noise Contrastive Estimation, NCE) 목적을 통해 비교함으로써 공동 의미론적 표현을 인코딩하였다. 구체적으로, 지역 $r_i$에 대해, mobility view의 임베딩과 geospaitial view의 임베딩이 서로 ground-truth가 되며, 긍정적인 쌍 $(e_ {r_ {i}}^{m}, e_ {r_ {i}}^{g})$으로 간주하였다. 그리고 다른 뷰에서 다른 지역들의 임베딩을 샘플링 함으로써, 부정적인 쌍( $(e_ {r_ {i}}^{m}, e_ {r_ {n}}^{g})$, $(e_ {r_ {n}}^{m}, e_ {r_ {i}}^{g})$ , $n \neq i$)을 정의하였다.</p>

<p>이후, 어떤 pair of ($e^{m}$,$e^{g}$)에 대해서, 매핑될 수 있도록 alignment 절차를 수행하였으며, 이 과정을 학습하기 위해서 InfoNCE loss function을 사용하였다. 
최종적으로는 학습하고 싶은 co-semantics 지역 프로필 $ê_{c} = \text{Align}(e^ {m}, e^ {g}) = \text{ReLU}(W([e^ {m} \Vert e^{g}] + b))$ 로 계산 된다.</p>

<p>[3] <strong>Cross-view Attention Fusion로 지역 임베딩 통합</strong>
저자는 마지막으로, cross-view attention 매커니즘으로 view간의 co-semantics와 view만의 uniqueness를 퓨전하여 지역 프로파일링의 표현력을 강화하였다.</p>

<p>이때,   co-semantic 임베딩($E^{c} = {e^{c}}$)은 키로 간주되며, 모든 임베딩은 쿼리로 사용하였다. 다음과 같이 키 행렬 $K$와 쿼리 행렬 $Q^{*}$ ($ * \in {m, c, g}$)를 다음과 같이 연관시켰다:</p>

<p>$K = E^{c} W_ {k}, \quad Q^{*} = E^{*}W_ {q}.$</p>

<p>여기서 $W_ {k}$와 $W_ {q}$는 학습 가능한 매개변수이다.</p>

<p>그런 다음, 아래와 같이 단일 뷰를  co-semantic 뷰와 융합하여 최종 지역 표현을 얻었다:</p>

<p>$A^{*} = \text{softmax} \left( \frac{ Q^{*} K^{T} }{\sqrt{D_ {R}} } \right), \quad E = A^{m} E^{m} + A^{c} E^{c} + A^{g} E^{g}$</p>

<p>따라서  co-semantic과 뷰별 uniqueness을 합쳐서  종합적인 특징을 포함하는 지역 프로파일링, $E = {e}$를 추출할 수 있게 되었다.</p>

<p>[4] <strong>Training objective</strong>
위의 1,2,3을 잘 수행할 수 있도록, 저자는 아래와 같이 adjustable weights $\beta_{1},\beta_{2}, \beta_{3}$을 갖는 아래의 Loss를 설계하였다.<br />
$L_{emb} = \beta_ {1} L_{mob} + \beta_ {2} L_ {inter} + \beta_ {3} L_ {geo}$</p>

<ul>
  <li>
    <p>첫째로, $L_ {mob}$은 지역 프로필 $e_ {i}$, $e_ {j}$가 있는 지역 $r_ {i}$, $r_ {j}$에 대한 전이 확률을 추정할 수 있다라는 것을 토대로, 아래와 같은 loss를 정의하였다.
$L_ {mob} = \sum_ {(r_ {i}, r_ {j}) \in R} -p_ {o}(r_ {j} | r_ {i}) \log \hat{p}_ {o}(r_ {j} | r_ {i}) - p_ {d} (r_ {j} | r_ {i}) \log \hat{p}_ {d} (r_ {j} | r_ {i})$<br />
이때, 추정된 전이확률은 다음과 같다.
$\hat{p}_ {o}(r_ {j}|r_ {i}) = \frac{\exp(e_ {r_i}^T e_ {r_ {j}})}{\sum_k \exp(e_ {r_ {i}}^T e_ {k})}$</p>
  </li>
  <li>
    <p>둘째로, $L_{inter}$는 infoNCE loss function을 활용해 아래와 같이 설계했다.
$L_ {inter} = \sum_ {r_ {i} \in R} \left[ - \log M(e_ {r_ {i}^m }, e_ {r_ {i}}^{g}) + \log \left( M(e_ {r_ {i}}^{m}, e_ {r_ {i}}^{g}) + \sum_ {e_ {r_ {n}}^m \in \hat{E}^{m}} M(e_ {r_ {n}}^{m}, e_ {r_ {i}}^{g}) + \sum_ {e_ {r_{n}}^{g} \in \hat{E}^{g}} M(e_ {r_ {i}}^{m}, e_{r_{n}}^{g}) \right) \right]$</p>
  </li>
  <li>
    <p>셋째로, $L_ {geo}$는 학습된 지역 프로필이 지역 특성 측면에서의 지역 유사성을 보존한다는 점을 활용해, 지역 프로필을 기반으로 지역 상관 관계를 재구성하는 방식을 이용했다.<br />
따라서, loss는 $c_{geo}(r_ {i}, r_ {j}) = \text{CosSim}(f_ {r_ {i}}, f_ {r_ {j}})$를 라벨로 사용하여, $L_ {geo} = \sum_ {(r_ {i}, r_ {j}) \in R} (c_ {geo}(r_ {i}, r_ {j}) - e_ {r_ {i}}^{T} e_ {r_ {j}})^{2}$로 정의된다.</p>
  </li>
</ul>

<h3 id="2-region-adaptive-st-prediction-model"><strong>2. Region-Adaptive ST Prediction Model</strong></h3>
<p>저자는 그림의 (b)부분의 모델을 제시하여 추출된 지역 프로필을 기반으로 부정적인 잡음을 배제하는 메타러닝을 개발하였다.</p>

<p>[1] <strong>Base mode</strong>
저자는 과거의 도시 시공간 ST 시퀀스를 기반으로 다음 도시 상태를 예측하도록 설계된 base model을 사용했다. 이 모델은 도시 상태의 동태에 내재된 복잡한 시공간 의존성을 모델링하는 것을 목표로 한다. 인접 지역은 상호 영향을 미치며, 지역의 이전 상태는 후속 상태에 영향을 주도록 하였다.</p>

<p>이를 모델링하기 위해, 저자는 공간적 상관관계를 모델링하기 위한 GAT(Graph Attention Network)와 각 지역의 시간적 진화를 캡처하기 위한 GRU(Gated Recurrent Unit)를 사용하는 하이브리드 GAT-GRU 모델을 사용하였다.</p>

<p>지역 $r_{i}$를 중심으로 한 그래프 기반의 attention 메커니즘을 사용하여 인접 지역과의 관계를 학습하기 위해 사용되는 구체적인 절차는 다음과 같다. 먼저, 저자는 공간적 관계를 모델링하는 그래프 어텐션 네트워크(GAT)에 있는 attention score, $\alpha_ {ij}^{s}$를 계산하였다. 다음으로, attention score를 이용하여, 지역의 의존성을 포함하는 새로운 표현 $\vec{z}_ {r_i}^{(t)}$을 계산하였다. 이는 인접한 지역들의 정보를 가중치 $\alpha_ {ij}^{s}$에 따라 종합함으로써 구하였다. 그리고 GRU를 통해  시간에 따른 지역의 동태를 모델링 하였다. GRU의 출력  $\hat{y}_ {r_ {i}}^{(t+1)}$는 시간 t+1에서 지역 $r_{i}$의 다음 상태를 예측하는 값으로 사용하였다.</p>

<p>[2] <strong>Regional Bias Generator</strong>
‘Regional Bias Generato’는 각 지역의 고유한 특성을 반영하는 매개변수를 생성하여 예측 모델에 적용하도록 돕는 역할을 한다. 저자들이 지역에 편향을 할당한 이유는, 각 지역들이 마다 성격이 다른 현실 세계를 반영하기 위함이다. 예를 들어, 비즈니스 센터와 산업 공원 간의 교통 패턴은 완전히 다른 상황 등이 있다.</p>

<p>저자는 각 지역에 대한 구별되는 특징을 반영하기 위한 편향을 할당하기 위해, 지역 프로파일을 특정 ST 상관관계를 포착하는 ST 예측 신경망의 중요한 메타 데이터로 보았다. 저자는 지역 $r_i$에 대해서, 해당 지역 임베딩 $e_ {r_ {i}}$를 지역 프로파일 메모리 $E$에서 검색하도록 했다. 그리고 Regional Bias Generator는 지역 프로파일의 메타 지식을 입력으로 받아 비공유 편향 매개변수 $b_ {r_ {i}}$를 출력한다. 공식적으로, 저자는 전체 편향 생성기 네트워크의 학습 가능한 가중치를 $\eta$로 표시하며, $N_P$는 기본 모델의 매개변수 수이도록 했다.</p>

<p>구체적으로, 저자가 설계한 Regional Bias Generator는 두 개의 변환 $F_1 : \mathbb{R}^{D_R} \rightarrow \mathbb{R}^{D_ {O}}$, $F_2 : \mathbb{R}^{D_ {O}} \rightarrow \mathbb{R}^{N_ {P}}$로 구성된 함수 $F_ {\eta}(\cdot)$이다.  저자는 두 개의 완전 연결 계층으로 Regional Bias Generator를 구현하였다. 작업 클러스터링 스킴과 비교하여, 이 방법은 미분 가능성과 해석 가능성을 더 잘 보장할 수 있다. 또한, 다양한 ST 동태를 고려할 뿐만 아니라, 한 지역 프로파일이 다른 지역과 유사할 때, 초기 예측 네트워크는 매개변수 조정을 통해 여전히 유사한 경향이 있으며, 이는 지역 프로파일과 ST 동태 간의 내재된 상관관계가 잘 연결되고 학습되도록 보장하도록 했다.</p>

<p>[3] <strong>Model Optimization</strong>
<img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure6.png" alt="image6" /></p>

<p>메타 최적화는 모든 태스크들이 공유하는 일반성을 이용하여 적은 수의 샘플로 지역들을 잘 예측하게끔 돕고, 지역 특정의 시공간(ST) 동태를 추가로 모델링으로써, 예측 모델의 신뢰성을 높이고 부정적인 transfer 문제를 완하는 과정이다. 이를 위해, 저자들은 일반화 가능한 공유 파라미터와 가변적인 편향을 사용하여 지역 적응 예측을 수행하는 편향 초기화 메타러닝 전략을 제시했다.</p>

<p>이를 수행하기 위한 알고리즘은 위 그림과 같으며, 주요 단계는 아래 두개와 같다.</p>
<ul>
  <li>
    <p>로컬 업데이트 (Local Update): 특정 지역을 위한 로컬 네트워크는 좋은 로컬 최적점으로 수렴하도록 만드는 단계이다. 이는 전통적인 신경망 훈련 방식과 유사하다. 로컬 네트워크는 각 훈련 태스크 $T_{ri}$에 대한 예측 손실을 최소화하며 각 태스크의 지원 집합 $D_{ri}^{sp}$을 사용하여 로컬 학습률 $\alpha$로 업데이트한다.</p>
  </li>
  <li>
    <p>글로벌 업데이트 (Global Update): 공유되는 일반화 가능한 예측 모델 $\theta^<em>$와 적은 수의 샘플 태스크에 적합한 효과적인 편향 생성기 $\eta^</em>$를 얻는 것을 목표로 한다. 이는 프로파일과 ST 동태를 연결한다. 로컬 업데이트 후, 한 단계의 그래디언트 감소를 통해 두 파라미터를 쿼리 세트 $D_{ri}^{qr}$의 손실 합계에 기반하여 업데이트한다.</p>
  </li>
</ul>

<h2 id="5-experiment"><strong>5. Experiment</strong></h2>

<h3 id="experiment-setup"><strong>Experiment setup</strong></h3>
<ul>
  <li>Dataset<br />
<img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure3.png" alt="image3" />
    <ul>
      <li>위의 테이블에서 보이는 데이터의 설명에서와 같이, 180개 지역에서 발생한 택시 이동 데이터, POI 관심 지점 데이터, 도로 네트워크 데이터를 가지는 뉴욕시 공개 데이터를 활용하였다.</li>
    </ul>
  </li>
  <li>Task
    <ul>
      <li>저자는 지역의 미래 픽업 및, 하차량을 예측하는 것을 과제로 설정하고 택시 이동 데이터를 사용해서 실험을 수행하였다.  각 지역에 대해서 30분 단위로 volume을 계산하였고, 대략 5760 time slot 중에 80%를 학습 데이터로 나머지 20%를 평가를 위해 사용하였다.</li>
    </ul>
  </li>
  <li>baseline
    <ul>
      <li>저자는 GAT-GRU 기반의 모델들을 baseline으로 사용하였다. 구체적인 모델은 DCRNN, MAML, ST-MetaNet, MetaPTP</li>
      <li>그리고, MetaRSTP의 임베딩 방식을 평가해보기 위해, MetaRSTP의 임베딩 방식을 node2Vec, MVURE, MGFN, ReMVC의 multi-view region profiling 방식으로 임베딩을 바꿔보았다.</li>
    </ul>
  </li>
  <li>Evaluation Metric
    <ul>
      <li>저자는 성능 비교를 위해, MAE와 RMSE를 사용하였다.</li>
    </ul>
  </li>
</ul>

<h3 id="result"><strong>Result</strong></h3>

<p>저자는 먼저, 현 MetaRSTP가 기존 방법들보다 few-shot 시나리오와 common 시나리오에서 좋은지 살폈다. 
<img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure4.png" alt="image4" /></p>

<p>그 결과, 위의 결과에서 보듯 픽업 및 하차량 예측에 대한 성능이 기존의 모든 연구보다 좋다고 나타났다. 저자가 제시한 임베딩 방식이 기존 임베딩 방식보다 좋으며, 모델 구조 또한 더 좋은 성능을 냈다. 특히, K가 훈련 샘플 비율을 나타내는데, 5%,10%,15%의 소수샷 시나리오에서도 예측을 잘하고 있다는 것을 알 수 있다.</p>

<p>다음으로, 저자는 제안된 방법 중에 어떤 것이 영향을 성능 향상에 영향을 미쳤는지 ablation study를 수행하였다. 
<img src="../../images/DS503_24S/Region_Profile_Enhanced_Urban_Spatio_Temporal_Prediction_via_Adaptive_Meta_Learning/figure5.png" alt="image5" /></p>

<p>그 결과, 여러 뷰의 정보를 고려하는 MetaRSTP는 단일 뷰 데이터만 고려하는 모델보다 일반적으로 더 나은 성능을 보였다. 또한,  결합 연산과 정렬 연산은 모두 중요하였다. 뷰 결합과 의미 정렬을 제거한 변형 모델은 완전한 버전보다 성능이 떨어졌으며, 이는 뷰 간 정보 전파의 중요성을 최대한 활용하고 각 뷰의 독특한 표현력을 보장하는 데 중요함을 입증하였다. 
마지막으로, 메타러닝 프레임워크 없이 기본 모델만 사용하는 경우와 지역 특화 지식 없이 동일한 초기화를 사용하는 MAML 모델은 지역별로 미세 조정에 실패하면서 퇴화하였고, MetaRSTP보다 성능이 떨어졌다. 이는 편향 생성 방법이 각 지역에 대해 신뢰할 수 있는 초기 네트워크를 도출하고 다양한 지역 간 지식을 전달하는데 도움이 됨을 증명하였다.</p>

<h2 id="5-conclusion"><strong>5. Conclusion</strong></h2>
<p>이 논문에서 저자는 MetaRSTP, 적응형 메타러닝 프레임워크를 제안하였다. 이 프레임워크는 strong 지역 프로파일을 통해 소수샷 시나리오에서 개인화된 시공간(ST) 예측 성능을 향상시키는 것을 목적으로 하였다. 먼저 의미론적 정렬과 fusion을 통해 지역의 기능을 밝힐 수 있는 포괄적인 다중 뷰 지역 프로파일을 학습하였다. 이어서 Regional Bias Generator는 지역 프로파일과 ST 동태 간의 내재된 상관관계를 추가로 모델링하였다. 그 다음으로 편향 초기화 메타러닝 전략은 지역 불특정의 일반성과 지역 특정의 의미론을 미세 조정에 결합함으로써 소수샷 시나리오에서 더 나은 지역 적응 예측을 가능하게 하였다. 마지막으로 실세계 데이터셋에서 실시한 광범위한 실험들은 MetaRSTP의 우수성과 지역 프로파일의 유효성을 입증하였다.</p>

<p><strong>소감.</strong></p>
<ul>
  <li>지역간의 근접성과 지역내의 근접성을 활용하여 각자의 특징을 뽑고 서로의 공통적인 특징을 뽑아 지역 프로파일링을 추출하는보며, 단순히 데이터를 사용하는 것이 아니라 관계를 이용하는  것이 중요하다는 것을 깨달았다.</li>
  <li>
    <h2 id="지역간의-근접성으로-co-semantic-관계를-뽑을-수-있다면-반대로-지역간의-non-semantic도-모델에-반영할-수-있었으면-좋겠다고-생각했다-예를-들면-도시와-시골등의-관계를-활용하는-것등이-있다">지역간의 근접성으로 co-semantic 관계를 뽑을 수 있다면, 반대로 지역간의 non-semantic도 모델에 반영할 수 있었으면 좋겠다고 생각했다. 예를 들면 도시와 시골등의 관계를 활용하는 것등이 있다.</h2>
  </li>
</ul>

    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2024 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Apr 24, 2024 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>



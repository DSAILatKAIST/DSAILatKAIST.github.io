<!DOCTYPE html>
<html>
<head>
    <meta name="google-site-verification" content="1tAPTdgw0-t8G2Bya463OpBtYUbj9Um93gfnsowYKLw" />
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV4PTXQSTW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CV4PTXQSTW');
</script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="reviews,  ">
<title>[NeurIPS 2022] Simulation-guided Beam search for Neural Combinatorial Optimization | Awesome Reviews</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="DSAILatKAIST.github.io" href="http://localhost:4000/feed.xml">


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>




    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    


	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	TeX: {
		equationNumbers: {
		autoNumber: "AMS"
		}
	},
	tex2jax: {
		inlineMath: [ ['$', '$'] ],
		displayMath: [ ['$$', '$$'] ],
		processEscapes: true,
		}
	});
	MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
	MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
		alert("Math Processing Error: "+message[1]);
	});
</script>

<script type="text/javascript" async
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script type="text/javascript" async
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Awesome Reviews</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="introduction">Introduction</a></li>
                
                
                
                <li><a href="https://statistics.kaist.ac.kr/" target="_blank" rel="noopener">KAIST ISysE</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reviews<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="reviews_kse801_2022.html">KSE801 (2022)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2023.html">DS503 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS535_2023.html">DS535 (2023)</a></li>
                        
                        
                        
                        <li><a href="reviews_DS503_2024.html">DS503 (2024)</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:swkim@kaist.ac.kr?subject=Question about reviews feedback&body=I have some feedback about the [NeurIPS 2022] Simulation-guided Beam search for Neural Combinatorial Optimization page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="[NeurIPS 2022] Simulation-guided Beam search for Neural Combinatorial Optimization">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="How to contribute" href="#">How to contribute</a>
      <ul>
          
          
          
          <li><a title="How to contribute?" href="how_to_contribute.html">How to contribute?</a></li>
          
          
          
          
          
          
          <li><a title="Review template (Example)" href="template.html">Review template (Example)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reviews" href="#">Reviews</a>
      <ul>
          
          
          
          <li><a title="KSE801 (2022F)" href="reviews_kse801_2022.html">KSE801 (2022F)</a></li>
          
          
          
          
          
          
          <li><a title="DS503 (2023S)" href="reviews_DS503_2023.html">DS503 (2023S)</a></li>
          
          
          
          
          
          
          <li><a title="DS535 (2023F)" href="reviews_DS535_2023.html">DS535 (2023F)</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/math...">
</script>
<article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">[NeurIPS 2022] Simulation-guided Beam search for Neural Combinatorial Optimization</h1>
        <p class="post-meta"><time datetime="2024-04-17T00:00:00+09:00" itemprop="datePublished">Apr 17, 2024</time> /
            
            
            
            
            

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <h1 id="simulation-guided-beam-search-for-neural-combinatorial-optimization">Simulation-guided Beam Search for Neural Combinatorial Optimization</h1>

<blockquote>
  <h2 id="0-abstract"><strong>0. Abstract</strong></h2>
</blockquote>

<p>최근, 강화학습을 활용하여 순차적 의사결정을 통해 solution을 구성해가는 방법(policy)을 학습하여 Combinatorial Optimization 문제를 푸는 deep learning 기반 방법론들이 많이 제안되고 있다.  neural net을 통한 방식은 한번의 실행으로(greedy select) 빠른 시간 안에 high-quality solution을 얻을 수 있지만, 이러한 방식은 솔루션 도출을 위해 사용 가능한 시간(초단위의 빠른 솔루션 도출이 아닌 더 긴 시간을 활용할 수 있는 경우)을 충분히 활용하지 못하는 아쉬움이 있다. <strong>본 논문은 사용 가능한 시간을 충분히 활용하기 위해 강력한 solution search 절차를 제공하고자 하는 목표로 simulation-guided beam search(SGBS)를 제안한다.</strong> SGBS는 solution을 형성해가는 decoding 단계에서 solution 후보에 대해 학습된 neural net policy를 활용하여 평가하고, 이를 활용하여 더 좋은 solution을 찾아가고자 한다. 또한 SGBS와 Efficient active search(EAS)를 결합한 SGBS+EAS를 제안함으로써 solution의 quality를 더욱 향상시키고자 한다. TSP, CVRP, FFSP task 대한 실험을 통해, 본 논문의 방법이 합리적인 시간안에 솔루션을 크게 향상시키고 optimal에 근사한 값을 도출하는 것을 확인할 수 있다.</p>

<blockquote>
  <h2 id="1-problem-definition--motivation"><strong>1. Problem definition &amp; Motivation</strong></h2>
</blockquote>

<p>Neural Network을 통해 combinatorial optimization(CO) 문제를 푸는 연구는 최근 많은 관심을 받고 있다. 강화학습을 통해, 전문가의 지식 혹은 정답에 대한 label 없이도 high-quality solution을 제공할 수 있도록 Deep neural net을 학습시킬 수 있기 때문이다.</p>

<p>CO문제의 solution은 neural network에 의해 계산된 policy(action에 대한 probability distribution)를 따라 순차적 의사결정에 의해 step-by-step manner [Construction method]로 이뤄진다. 이전의 대부분 연구들은 효과적인 policy를 도출하기 위한 neural network 설계, 즉 construction method 연구에 집중해온 반면, construction method에 의해 decoding 단계에서 도출되는 solution을 더욱 향상시키고자, test 단계에서 solution의 quality를 개선하는 방법론인 inference method에 대한 연구는 거의 이뤄지지 않았다. 기존에 MCTS(Monte-Carlo tree search), Beam search와 같은 전통적인 search 전략들이 활용되어 왔지만, 너무 많은 시간이 요구되거나, 효과적이지 못한 문제점들이 존재했다. 따라서 본 논문에서는 기존 방법론들의 단점들은 보완하면서 장점은 살리고자 MCTS와 beam search를 결합한 simulation-guided beam search(SGBS) 전략을 제안한다. 또한 SGBS의 performance를 더욱 향상시키고자 efficient active search(EAS)와 결합된 SGBS+EAS도 함께 제안한다.</p>

<ul>
  <li><em>논문을 이해하기 위해선 EAS와 관련된 사전지식 필요하여, EAS 관련 내용은 이후  method 부분에서 기술함</em></li>
</ul>

<blockquote>
  <h2 id="2-method"><strong>2. Method</strong></h2>
</blockquote>

<ul>
  <li><strong>2.1 Preliminaries</strong></li>
</ul>

<p>N개의 decision variable $a_ {0},a_ {1},…,a_ {n-1}$을 가진 일반적인 CO 문제를 가정한다. CO문제를 풀 때, 우리의 목표는 objective function을 최대화/최소화하는 솔루션(= decision variable의 sequence)을 찾는 것이다. 이를 위해 θ에 의해 매겨변수화된 $π_ {θ}(a_ {d} \vert s_ {d})$를 만들고, 이를 이용해 한 번에 하나씩 solution을 생성해 간다. (매 step마다 decision variable 중 하나를 선택해가며 solution을 구성해감) 예를 들어, Partially completed(d&lt;N)된 solution $s_ {d}$에 대해, 신경망에 의해 도출된 확률분포 $π_ {θ}(a_ {d} \vert s_ {d})$ 에 따라 $a_ {d}$를 선택하여 솔루션을 생성해가는 방식이다. 빈 solution tuple($s_ {0}=()$)로부터 시작하여, 위와 같은 절차를 complete solution($s_ {N}=(a_ {0}, a_ {1},…, a_ {N-1})$)이 생성될 때까지 반복한다.</p>

<p>Policy-based reinforcement learning 에서 $π, s_ {d}, a_ {d}, R(s_ {N})$은 각각 policy, state, action, reward에 해당한다. 이때 reward(objective value)는 complete solution이 생성되어야 지만 알 수 있다. Policy neural net( $π_ {θ}$)의 파라미터 θ는 expected reward를 증가/감소시키고자 강화학습을 통해 점진적으로 업데이트 되어진다.</p>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image.png" alt="" />
<!-- ![image.png](https://i.postimg.cc/rpwsWXJ2/image.png) --></p>

<p><em>P</em>는 target problem instances의 distiribution을 의미하며, <em>R’</em>은 <em>P</em>에서 sampling된 instance를 의미한다.</p>

<ul>
  <li><strong>2.2 SGBS Algorithm and its three phases</strong></li>
</ul>

<p>CO 문제는 depth가 d인 노드가 partially completed solution인 $s_ {d}$를 나타내고 이 노드에서의 branch는 $s_ {d}$상태에서 d+1번째 decision variable을 표현하는 decision tree에서의 search problem으로 볼 수 있다. 즉 문제의 목적은 objective function을 최대화/최소화하는 root node부터 leaf node까지의 path(decision variable의 sequence를 표현)를 찾는 문제로 볼 수 있다.</p>

<p>SGBS 알고리즘은 solution을 만들어가는 decoding 과정에서 root node로부터 시작해서(빈 solution tuple) 매 step마다 solution 후보를 탐색하고, 탐색 결과를 바탕으로 tree의 depth를 확장해 간다(=순차적 의사결정을 통해 솔루션을 구성해 감).</p>

<p>각 depth level에서 SGBS는 3가지 동작을 수행한다: <strong><em>1) expansion, 2) simulation, 3) pruning</em></strong></p>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (1).png" alt="" />
<!-- ![image1.png](https://i.postimg.cc/dVHTtjMB/image.png) --></p>

<p><strong>2.2.1 Expansion(Pre-Pruning)</strong></p>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (2).png" alt="" />
<!-- ![image2.png](https://i.postimg.cc/sDwgzf7d/image.png) --></p>

<p>Expansion factor Γ가 주어지면, <strong>각 beam에 포함된 노드(파랑색 노드) $s_ {d}$로부터 가능한 모든 자식 노드 중 가장 큰  $π_ {θ}(. \vert s_ {d})$를 가진(다음 의사결정으로 선택될 확률이 높은) 상위 Γ개의 자식노드가 선택된다.</strong> 따라서 각 depth마다 expansion 단계에서 Β * Γ 개의 자식노드가 선택되고 나머지는 node는 search tree로부터 가지치기 된다.</p>

<p><strong>2.2.2 Simulation</strong></p>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (3).png" alt="" />
<!-- ![image3.png](https://i.postimg.cc/qMs6fdM2/image.png) --></p>

<p>Expansion 단계에서 선택된  Β * Γ 개의 child node에 <strong>greedy rollout</strong> (policy에 따라 greedy action selection을 통해 solution을 끝까지 만들어 보는 것) 을 진행한다. Greedy rollout을 통해 각 child node의 complete solution을 구하고, 이때의 reward를 계산한다. 이를 통해 child node의 objective value를 알 수 있다.</p>

<p><strong>2.2.3 Pruning</strong></p>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (4).png" alt="" />
<!-- ![image4.png](https://i.postimg.cc/PxbbSvc8/image.png) --></p>

<p><strong>Β * Γ 개의 child node중 reward 기준 상위 Β개의 reward를 가진 node가 다음 step의 Beam node가 된다.</strong> 선택되지 못한 나머지 child node는 가지치기 돼서 앞으로 고려되지 않는다.</p>

<p>위와 같은 3가지 과정을 모든 path가 completed solution을 구성할 때까지 반복하고, 최종적으로 생성된 여러 path중, best solution이 최종 solution으로 선택된다.</p>

<ul>
  <li><strong>2.3 SGBS + EAS</strong></li>
</ul>

<p>SGBS의 search 과정동안 neural net의 파라미터는 바뀌지 않으므로(같은 state에 대해 policy distribution이 변하지 않으므로) 고정된 Β, Γ가정하에 고정된 결과만을 보여준다. (greedy action을 한다는 가정하에, 여러 번 SGBS를 실행할 필요X) 이에 주어진 시간을 충분히 활용하면서 SGBS의 performance를 더욱 향상시키고자 EAS와 결합된 <strong>SGBS+EAS</strong>를 제안한다.</p>

<hr />

<blockquote>
  <p><strong>Efficient Active Search(EAS)</strong> : <a href="https://arxiv.org/abs/2106.05126">Hottung et al., 2022</a>에서 제시된 Efficient Active Search(EAS)는 기존에 제시되었던 inference method인 active search를 효과적으로 개선한 버전이다.  <a href="https://arxiv.org/abs/1611.09940">Bello et al., 2017</a>에서 제시한 Active search는 강화학습을 통해 test시 single instance에 대해 추론 성능을 높이고자 학습된 모델의 파라미터를 조정하는 fine-tuning 과정을 거치는데, 각 test instance마다 모델의 모든 가중치를 조정하므로 시간과 메무리가 너무 많이 요구되고, 효과적이지 못한 문제가 있었다. EAS는 모델의 모든 parameter를 조정하는 대신, search 과정동안 모델 파라미터 일부 subset만 update하는 전략을 제시했다.</p>

  <p>본 논문에서는 EAS 전략 중, EAS-Lay 전략을 사용했다. EAS-Lay란 훈련된 모델에 추가적인 layer(논문에선 residual layer라고 지칭)를 삽입하는 방식으로, inference 과정 중 새로 삽입된 layer의 파라미터만 업데이트 되고, 기존 모델의 가중치는 고정된다. 실험을 통해 EAS -Lay전략이 inference method로 아주 효과적임이 밝혀져있다.</p>

  <p>다음과 같은 두 식의 결합을 loss function의 gradient로써 사용해서 삽입된 layer의 파라미터를 update한다.
<img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (5).png" alt="" />
<!-- > ![image5.png](https://i.postimg.cc/HnnGwMsT/image.png) --></p>

  <p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (6).png" alt="" />
<!-- > ![image6.png](https://i.postimg.cc/sxJgH75q/image.png) --></p>

  <p>(1) 수식은, 일반적인 REINFORCE with baseline algorithm에 따른 gradient로 생성된 solution들의 expected cost를 줄이는 것을 목적으로 한다. baseline으로는  <a href="https://arxiv.org/abs/2010.16011">Kwon et al., 2020</a> 에서 제시한 POMO baseline을 사용하였다. (2) 수식은 tearcher forcing을 활용한 imitation loss gradient이다. 이를 통해 search 과정 중 찾은 best solution의 의사결정 과정을 모방하도록 학습된다. 전체적인 loss의 gradient는 다음과 같이 두 gradient의 가중합으로 정의된다.</p>

  <p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (7).png" alt="" />
<!-- > <img src="https://i.postimg.cc/q7dnFXKM/image.png" alt="image7.png" style="zoom:80%;" /> --></p>

  <p>λ는 사용자 파라미터로, 높은 λ value를 설정한다면, 현재까지 찾은 솔루션 중, best solution을 모방하는데 focus하여 모델의 파라미터가 튜닝될 것이다.</p>
</blockquote>

<hr />

<p>SGBS+EAS의 알고리즘은 다음과 같다.</p>

<blockquote>
  <p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (8).png" alt="" />
<!-- ![image8.png](https://i.postimg.cc/J7c133r5/image.png) --></p>
</blockquote>

<p><strong>SGBS는 광범위하고 효과적인 search procedure를 통해 현재 솔루션을 개선함으로써 EAS가 local optimal로부터 벗어날 수 있도록 돕고</strong>(search를 통해 더 좋은 solution을 찾아갈 수 있으므로), 동시에 <strong>EAS가 모델 파라미터를 지속적으로 업데이트 함으로써 SGBS가 새로운, 이전과 겹치지 않는 searh tree를 생성할 수 있게 한다.</strong> 즉 EAS를 통해 search tree의 탐색 영역을 더 pormising한 search space로 보내고, promising한 space에서의 SGBS를 통한 search procedure를 통해 solution quality를 더욱 향상시킬 수 있다.</p>

<blockquote>
  <h2 id="3-experiments"><strong>3. Experiments</strong></h2>
</blockquote>

<ul>
  <li><strong>3.1 Performance of different search methods for the CVRP in three (a)-(c) scenarios</strong>
    <ul>
      <li><strong>Experiments setting</strong>
        <ul>
          <li>SGBS의 효과를 검증하고자 3가지 다른 시나리오 환경을 구상하고 실험 진행</li>
          <li>node가 100개 존재하는 CVRP 문제를 대상으로 진행</li>
          <li>solution을 만드는 trained model은 같은 model 사용</li>
          <li>Greedy를 제외한 각각의 method는 1200번의 search를 수행하고 Best solution 도출</li>
          <li>SGBS parameter: (Β=4, Γ=4)</li>
          <li>Y축: HGS algorithm에 의해 얻어진 solution과의 gap</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (9).png" alt="" />
<!-- ![image9.png](https://i.postimg.cc/RF1zR9BZ/image.png) --></p>

<p><strong>(a) 시나리오</strong>: 학습한 instance와 같은 distribution에서 sampling된 instance에 대한 실험 진행. EAS를 제외하고는 SGBS가 가장 좋은 효과를 보여주었다.</p>

<p><strong>(b) 시나리오</strong>: 학습한 instance와 다른 distribution에서 sampling된 instance에 대한 실험 진행. 즉 기존 trained model로는 좋은 성능을 내기 어려운 상황(domain shift)을 가정하였다.</p>

<p>실험 결과, SGBS 방법이 가장 우수한 성능을 보여주었다. MCTS 방법도 유사한 성능을 보여주었지만, 계산 시간이 너무 오래 걸린다는 단점이 있다. <strong>이처럼 instance의 distribution이 바뀌는 경우, 기존에는 model의 re-train이 요구되었지만 SGBS를 활용한다면 짧은 시간에 매우 효과적인 성능을 보여줄 수 있다. (본 논문의 주요 contribution!)</strong></p>

<p><strong>(C) 시나리오</strong>: search 진행하기 이전에 test instance에 대해 fine-tuning 진행한 시나리오. 저자들이 말하길, 다른 method의 경우 local optimal에 빠지는 것을 확인할 수 있었지만, <strong>SGBS의 경우 광범위한 탐색을 통해 solution을 찾아가므로 local optima 문제로부터 비교적 자유로운 것을 확인할 수 있다.</strong> 또한 이는 SGBS+EAS(fine-tuning + search procedure)가 어떻게 큰 성능 향상을 가져오는지에 대한 설명을 제공한다.</p>

<ul>
  <li>
    <p><strong>3.2  TSP  &amp; CVRP</strong></p>

    <p>NP-hard routing문제인 TSP, CVRP instance에 대해 다양한 instace size에 대한 실험을 진행하였다.</p>

    <p>TSP는 n 개의 node(cities)가 주어졌을 때, 모든 노드를 정확히 한 번만 방문하는 최단거리를 구하는 문제이다. CVRP는 TSP와 유사하지만 다른 점은 각 node마다 demand가 할당되고,  vehicle에 한 번(route)에 처리 가능한 deamd 합 제한인 capacity 제약이 추가된 문제이다.</p>

    <ul>
      <li><strong>Experiments setting</strong>
        <ul>
          <li>
            <p><a href="https://arxiv.org/abs/1803.08475">Kool et al., 2019</a>에서 제안한 instances generation 방식 사용</p>
          </li>
          <li>
            <p>노드가 100개인 instance 10000개로 Test 진행</p>
          </li>
          <li>
            <p>일반화 성능을 검증하고자 , Train instance와 다른 distribution에서 sampling된 노드가 100, 150, 200개인 instance 1000개씩 생성하여 Test 진행</p>
          </li>
          <li>Baseline algorithm:
            <ul>
              <li>TSP: Concorde, LKH3</li>
              <li>CVRP: HGS, LKH3</li>
            </ul>
          </li>
          <li>
            <p>비교 neural net기반 알고리즘: DACT, NLNS, DPDP, POMO, EAS 단독</p>
          </li>
          <li>
            <p>Our method: policy network를 학습시키기 위해  <a href="https://arxiv.org/abs/2010.16011">Kwon et al., 2020</a> 에서 제시된 <strong>POMO</strong> <strong>training algorithm</strong>[construction method] 사용. POMO는 REINFORCE algorithm을 기반으로 여러 CO 문제에서 좋은 성능을 보임이 검증되었다. (본 논문의 방법론은 inference method로,  construction method를 이용한 학습된 모델 필요. POMO이외에도 어느 construction method에도 적용 가능)</p>

            <p>한 epoch당 <a href="https://arxiv.org/abs/1803.08475">Kool et al., 2019</a>따라 random하게 생성된 instances 100000개를 사용하여 학습. TSP task는 1900epoch의 학습 진행하였고, CVRP instance에 대해서 10000epoch 학습 진행.</p>
          </li>
          <li>
            <p>두 가지 버전의 SGBS+EAS, EAS 실험 결과 제공: <strong>1)</strong> 특정 시간동안만 search 진행한 결과, <strong>2)</strong> 수렴할때까지 진행한 결과</p>
          </li>
          <li>SGBS parameter
            <ul>
              <li>TSP: Β=10, Γ=10</li>
              <li>CVRP: Β=4, Γ=4</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (10).png" alt="" />
<!-- ![image10.png](https://i.postimg.cc/3R8tsHGR/image.png) --></p>

<p><strong>Table1.</strong>은 Concorde알고리즘 대비 알고리즘들의 성능 Gap(%)을 보여준다. TSP, CVRP 실험에서 모두 SGBS+EAS가 모든 neural net기반 method를 능가하는 성능을 보여는 것을 확인할 수 있다. 또한  SGBS, EAS를 단독으로 사용하는 것보다 결합했을 때 더욱 효과적임을 볼 수 있다. 특히 CVRP 실험에선 SGBS+EAS가 routing에 특화된 매우 효과적인 알고리즘인 LKH3를 능가하는 성능을 보이며 합리적인 시간 안에 near-optimal 한 성능을 보여줌을 확인할 수 있다.</p>

<p>비록 SGBS+EA가 Concorde, HGS와 같은 baseline의 성능을 넘는 결과를 보여준 것은 아니지만, 주목할 점은 Concode와 HGS는 routing에 특화된 handcrafted-heurisitc 알고리즘이지만, SGBS+EAS는 여러 CO문제에 적용될 수 있는 general한 data-driven 방식이라는 점이다.</p>

<ul>
  <li>
    <p><strong>3.3 FFSP</strong></p>

    <p>SGBS는 routing문제에 특화된게 아니라 여러 CO 문제의 어느 construction method에도 적용할 수 있는 general inference method임을 보이고자, scheduling 문제 중 하나인 Flexible Flow shp problem(FFSP)에 대한 실험을 진행하였다.</p>

    <p>FFS란, 작업들이 여러 stage를 순차적으로 거치며 공정이 이뤄지는데, 각 stage마다 여러 machine이 존재하고 같은 stage에서는 같은 작업을 처리하더라도 machine마다 다른 처리속도를 가진 시스템을 말한다. 이때 한 machine에서는 한 번에 하나의 작업만 처리할 수 있다는 제약이 존재한다.</p>

    <p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (11).png" alt="" /></p>

    <!-- ![image11.png](https://i.postimg.cc/x1CXfHqn/image.png) -->

    <p>따라서 scheduling method는 작업을 각 stage에서 어느 머신에 할당할 것인지(machine selection), 각 머신에서 어떤 순서로 작업을 처리할 것인지(Jobs sequencing) 관한 의사결정을 수행해야 한다.</p>

    <ul>
      <li><strong>Experiments setting</strong>
        <ul>
          <li>
            <p><a href="https://arxiv.org/abs/2106.11113">Kwon et al., 2021</a>에서 제안한 instances generation 방식 사용</p>
          </li>
          <li>
            <p>3개의 stage, stage별 4개의 machine이 존재하는 상황</p>
          </li>
          <li>
            <p>작업이 20, 50, 100개 존재하는 instance를 각각 1000개씩 생성해서 Test 진행</p>
          </li>
          <li>
            <p>Baseline algorithm: MIP(CPLEX solver 이용), meta-heuristic solver, Neural Net base solver(Matnet)</p>
          </li>
          <li>
            <p>Our method: policy networ의 파라미터를 학습시키기 위해 train 단계에서 <a href="https://arxiv.org/abs/2106.11113">Kwon et al., 2021</a>에서 제시한 <strong>Matnet</strong> <strong>training algorithm</strong> [construction method] 사용. Matnet은 REINFORCE알고리즘에 기반하여 관계 데이터를 효과적으로 처리하고 좋은 성능을 보임이 검증되었다.</p>

            <p>한 epoch당 <a href="https://arxiv.org/abs/2106.11113">Kwon et al., 2021</a>따라 random하게 생성된 instances 1000개를 사용하여 학습. 20, 50, 100개의 작업을 처리하는 모델에 대해 각각 54, 95, 120 epochs 학습 진행</p>
          </li>
          <li>
            <p>두 가지 버전의 SGBS+EAS, EAS 실험 결과 제공: <strong>1)</strong> 특정 시간동안만 search procedure 진행한 결과, <strong>2)</strong> 수렴할때까지 진행한 결과</p>
          </li>
          <li>
            <p>SGBS parameter:  Β=5, Γ=6</p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="../../images/DS503_24S/Simulation-guided_Beam_Search_for_Neural_Combinatorial_Optimization/image (12).png" alt="" />
<!-- ![image12.png](https://i.postimg.cc/4Nf5Yn98/image.png) -->
<strong>Table2.</strong> 는 SGBS+EAS 대비 알고리즘들의 성능 Gap(%)을 보여준다. 실험 결과, SGBS+EAS method가 기존 방법론들을 크게 앞서는 것을 확인할 수 있다. CPLEX의 경우 합리적인 시간 내에 solution을 도출하지 못하였다.  meta-heuristic 알고리즘들 또한 매우 큰 연산시간이 걸린거에 비해 만족스러운 solution을 도출하지 못하였다.</p>

<blockquote>
  <h2 id="4-conclusion"><strong>4. Conclusion</strong></h2>
</blockquote>

<p>CO문제를 효과적으로 풀기 위해 simulation-guided bean search(SGBS)와 EAS가 결합된 inference method 제안하였다. 기존의 construction method와 손쉽게 결합될 수 있는 장점이 있다. 실험을 통해, SGBS+EAS가 solution을 quality를 크게 높이는 것을 확인할 수 있었으며, 전문가, 도메인 지식 없이도 state-of-the-art handcrafted heuristic method와 매우 근사한 near-optimal solution의 결과를 보여주었다.</p>

<p>SGBS를 단독으로 사용하는 것보다 EAS와 결합하여 사용함으로써 EAS에 의해 더 promising한 search space로 tree가 보내지고, promising한 space에서의 광범위한 tree search를 통해 solution의 quality를 높이는 상호유기적인 모습이 인상깊었다.</p>

<p>실제 환경은 학습한 instances distribution과 다른 distribution에서 sampling된 문제를 풀어야 하는 경우가 대다수일텐데, 이런 환경 속에서 모델을 매번 re-traning하는 것이 아니라 SGBS+EAS와 같은 inference method를 통해 빠른 시간 안에 fine-tuning하는 것이 실제 환경에서 매우 효과적일 것이라고 생각한다.</p>

<p>하지만, SGBS+EAS는 inference method로 여전히 효과적인 construction method에 의해 학습된 model이 요구된다. 어느 contsruction method 알고리즘에 붙어서 작용하냐에 따라 성능의 차이가 클 것이라고 예상된다. 따라서 어느 하나가 중요한게 아니라 서로 상호보완하며 같이 연구되고 성장하는 것이 중요할 것이라고 보인다.</p>

<h3 id="author-information">Author Information</h3>

<ul>
  <li><strong>Author</strong>: Inguk Choi
    <ul>
      <li><strong>Affiliation</strong>: KAIST MSS Lab</li>
      <li><strong>Research Topic</strong>: Neural Combinatorial Optimization, scheduling with Reinforcement Learning</li>
    </ul>
  </li>
</ul>

<blockquote>
  <h2 id="5-reference">5. Reference</h2>
</blockquote>

<p>[1] Choo, Jinho, et al. “Simulation-guided beam search for neural combinatorial optimization.” <em>Advances in Neural Information Processing Systems</em> 35 (2022): 8760-8772. <a href="https://arxiv.org/abs/2207.06190">[LINK]</a></p>

<p>[2] Kwon, Yeong-Dae, et al. “Pomo: Policy optimization with multiple optima for reinforcement learning.” <em>Advances in Neural Information Processing Systems</em> 33 (2020): 21188-21198. <a href="https://proceedings.neurips.cc/paper/2020/hash/f231f2107df69eab0a3862d50018a9b2-Abstract.html">[LINK]</a></p>

<p>[3] Kool, Wouter, Herke Van Hoof, and Max Welling. “Attention, learn to solve routing problems!.” <em>arXiv preprint arXiv:1803.08475</em> (2018). <a href="https://arxiv.org/abs/1803.08475">[LINK]</a></p>

<p>[4] Kwon, Yeong-Dae, et al. “Matrix encoding networks for neural combinatorial optimization.” <em>Advances in Neural Information Processing Systems</em> 34 (2021): 5138-5149.<a href="https://arxiv.org/abs/2106.11113">[LINK]</a></p>

<p>[5] Bello, Irwan, et al. “Neural combinatorial optimization with reinforcement learning.” <em>arXiv preprint arXiv:1611.09940</em> (2016).<a href="https://arxiv.org/abs/1611.09940">[LINK]</a></p>

<p>[6] Hottung, André, Yeong-Dae Kwon, and Kevin Tierney. “Efficient active search for combinatorial optimization problems.” <em>arXiv preprint arXiv:2106.05126</em> (2021).<a href="https://arxiv.org/abs/2106.05126">[LINK]</a></p>

<blockquote>
  <h2 id="6additional-materials"><strong>6.Additional materials</strong></h2>
</blockquote>

<p><a href="https://github.com/yd-kwon/SGBS">[Link for public code]</a></p>


    </div>



</article>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>







<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2024 Copyright 2021 Google LLC. All rights reserved. <br />
 Site last generated: Apr 22, 2024 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-66296557-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>





</html>


